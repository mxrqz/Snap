"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/snap/route";
exports.ids = ["app/api/snap/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "sharp":
/*!************************!*\
  !*** external "sharp" ***!
  \************************/
/***/ ((module) => {

module.exports = require("sharp");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsnap%2Froute&page=%2Fapi%2Fsnap%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsnap%2Froute.ts&appDir=%2FUsers%2Fmxrqz%2Fprojects%2Fmomentum%2Fsnap%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmxrqz%2Fprojects%2Fmomentum%2Fsnap&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsnap%2Froute&page=%2Fapi%2Fsnap%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsnap%2Froute.ts&appDir=%2FUsers%2Fmxrqz%2Fprojects%2Fmomentum%2Fsnap%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmxrqz%2Fprojects%2Fmomentum%2Fsnap&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_mxrqz_projects_momentum_snap_src_app_api_snap_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/snap/route.ts */ \"(rsc)/./src/app/api/snap/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/snap/route\",\n        pathname: \"/api/snap\",\n        filename: \"route\",\n        bundlePath: \"app/api/snap/route\"\n    },\n    resolvedPagePath: \"/Users/mxrqz/projects/momentum/snap/src/app/api/snap/route.ts\",\n    nextConfigOutput,\n    userland: _Users_mxrqz_projects_momentum_snap_src_app_api_snap_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/snap/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzbmFwJTJGcm91dGUmcGFnZT0lMkZhcGklMkZzbmFwJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGc25hcCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRm14cnF6JTJGcHJvamVjdHMlMkZtb21lbnR1bSUyRnNuYXAlMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGbXhycXolMkZwcm9qZWN0cyUyRm1vbWVudHVtJTJGc25hcCZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDYTtBQUMxRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3NuYXAvPzI5ZjgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL214cnF6L3Byb2plY3RzL21vbWVudHVtL3NuYXAvc3JjL2FwcC9hcGkvc25hcC9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvc25hcC9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3NuYXBcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3NuYXAvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvbXhycXovcHJvamVjdHMvbW9tZW50dW0vc25hcC9zcmMvYXBwL2FwaS9zbmFwL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9zbmFwL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsnap%2Froute&page=%2Fapi%2Fsnap%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsnap%2Froute.ts&appDir=%2FUsers%2Fmxrqz%2Fprojects%2Fmomentum%2Fsnap%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmxrqz%2Fprojects%2Fmomentum%2Fsnap&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/snap/route.ts":
/*!***********************************!*\
  !*** ./src/app/api/snap/route.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_services_microlink__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/services/microlink */ \"(rsc)/./src/lib/services/microlink.ts\");\n/* harmony import */ var _lib_services_image_processor__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/services/image-processor */ \"(rsc)/./src/lib/services/image-processor.ts\");\n/* harmony import */ var _lib_services_browser_mockup__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/services/browser-mockup */ \"(rsc)/./src/lib/services/browser-mockup.ts\");\n/* harmony import */ var _lib_validation__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/validation */ \"(rsc)/./src/lib/validation.ts\");\n\n\n\n\n\nfunction createErrorResponse(error, status = 400) {\n    const response = {\n        success: false,\n        error\n    };\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response, {\n        status\n    });\n}\nfunction createSuccessResponse(imageBuffer, url, metadata) {\n    const response = {\n        success: true,\n        imageUrl: `data:image/png;base64,${imageBuffer.toString(\"base64\")}`,\n        metadata: {\n            originalUrl: url,\n            processedAt: new Date().toISOString(),\n            dimensions: metadata\n        }\n    };\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response);\n}\nasync function processSnapshot(url, screenshotConfig, styleConfig) {\n    // Merge with defaults\n    const finalScreenshotConfig = {\n        ..._lib_services_microlink__WEBPACK_IMPORTED_MODULE_1__.MicrolinkService.getDefaultConfig(),\n        url,\n        ...screenshotConfig\n    };\n    const finalStyleConfig = {\n        ..._lib_services_image_processor__WEBPACK_IMPORTED_MODULE_2__.ImageProcessor.getDefaultStyle(),\n        ...styleConfig\n    };\n    // Optimize viewport for final image size if specified\n    // TODO: Temporarily disabled - using original config\n    // const optimizedScreenshotConfig = MicrolinkService.optimizeViewportForFinalSize(\n    //   finalScreenshotConfig,\n    //   finalStyleConfig.finalSize\n    // )\n    const optimizedScreenshotConfig = finalScreenshotConfig;\n    // Fetch screenshot from Microlink\n    const screenshotBuffer = await _lib_services_microlink__WEBPACK_IMPORTED_MODULE_1__.MicrolinkService.fetchScreenshot(optimizedScreenshotConfig);\n    // Apply browser mockup if specified\n    let processedBuffer = screenshotBuffer;\n    if (finalStyleConfig.browserMockup !== \"none\") {\n        processedBuffer = await _lib_services_browser_mockup__WEBPACK_IMPORTED_MODULE_3__.BrowserMockupService.applyMockup(processedBuffer, finalStyleConfig.browserMockup);\n    }\n    // Apply styling (borders, margins, gradients, shadows)\n    processedBuffer = await _lib_services_image_processor__WEBPACK_IMPORTED_MODULE_2__.ImageProcessor.processScreenshot(processedBuffer, finalStyleConfig);\n    // Get final dimensions\n    const sharp = (await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! sharp */ \"sharp\", 23))).default;\n    const metadata = await sharp(processedBuffer).metadata();\n    return {\n        buffer: processedBuffer,\n        metadata: {\n            width: metadata.width || 0,\n            height: metadata.height || 0\n        }\n    };\n}\nasync function GET(request) {\n    try {\n        const { searchParams } = new URL(request.url);\n        const queryParams = Object.fromEntries(searchParams.entries());\n        console.log(\"Query params received:\", queryParams);\n        if (!queryParams.url) {\n            return createErrorResponse(\"Missing required parameter: url\");\n        }\n        // Clean up empty string parameters\n        const cleanedParams = Object.fromEntries(Object.entries(queryParams).filter(([_, value])=>value !== \"\"));\n        const validatedQuery = (0,_lib_validation__WEBPACK_IMPORTED_MODULE_4__.validateSnapQuery)(cleanedParams);\n        const snapRequest = (0,_lib_validation__WEBPACK_IMPORTED_MODULE_4__.queryToRequest)(validatedQuery);\n        const { buffer, metadata } = await processSnapshot(snapRequest.url, snapRequest.screenshot, snapRequest.style);\n        return createSuccessResponse(buffer, snapRequest.url, metadata);\n    } catch (error) {\n        console.error(\"GET /api/snap error:\", error);\n        if (error instanceof Error) {\n            if (error.message.includes(\"ZodError\") || error.name === \"ZodError\") {\n                return createErrorResponse(`Validation error: ${error.message}`, 400);\n            }\n            if (error.message.includes(\"Screenshot fetch failed\")) {\n                return createErrorResponse(`Screenshot error: ${error.message}`, 503);\n            }\n            if (error.message.includes(\"Processing error\") || error.message.includes(\"Sharp\")) {\n                return createErrorResponse(`Image processing error: ${error.message}`, 500);\n            }\n            return createErrorResponse(`Server error: ${error.message}`, 500);\n        }\n        return createErrorResponse(\"Internal server error\", 500);\n    }\n}\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const validatedRequest = (0,_lib_validation__WEBPACK_IMPORTED_MODULE_4__.validateSnapRequest)(body);\n        const { buffer, metadata } = await processSnapshot(validatedRequest.url, validatedRequest.screenshot, validatedRequest.style);\n        return createSuccessResponse(buffer, validatedRequest.url, metadata);\n    } catch (error) {\n        console.error(\"POST /api/snap error:\", error);\n        if (error instanceof Error) {\n            if (error.message.includes(\"ZodError\") || error.name === \"ZodError\") {\n                return createErrorResponse(`Validation error: ${error.message}`, 400);\n            }\n            if (error.message.includes(\"Screenshot fetch failed\")) {\n                return createErrorResponse(`Screenshot error: ${error.message}`, 503);\n            }\n            if (error.message.includes(\"Processing error\") || error.message.includes(\"Sharp\")) {\n                return createErrorResponse(`Image processing error: ${error.message}`, 500);\n            }\n            return createErrorResponse(`Server error: ${error.message}`, 500);\n        }\n        return createErrorResponse(\"Internal server error\", 500);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUd4QixPQUFPL0Msc0JBQXNCMkIsUUFBUTJCLGlCQUFpQnBELEdBQUcsRUFBRUM7SUFDN0QsRUFBRSxPQUFPUixPQUFPO1FBQ2QyQyxRQUFRM0MsS0FBSyxDQUFDLHlCQUF5QkE7UUFFdkMsSUFBSUEsaUJBQWlCcUQsT0FBTztZQUMxQixJQUFJckQsTUFBTXNELE9BQU8sQ0FBQ0MsUUFBUSxDQUFDLGVBQWV2RCxNQUFNd0QsSUFBSSxLQUFLLFlBQVk7Z0JBQ25FLE9BQU96RCxvQkFBb0IsQ0FBQyxrQkFBa0IsRUFBRUMsTUFBTXNELE9BQU8sQ0FBQyxDQUFDLEVBQUU7WUFDbkU7WUFDQSxJQUFJdEQsTUFBTXNELE9BQU8sQ0FBQ0MsUUFBUSxDQUFDLDRCQUE0QjtnQkFDckQsT0FBT3hELG9CQUFvQixDQUFDLGtCQUFrQixFQUFFQyxNQUFNc0QsT0FBTyxDQUFDLENBQUMsRUFBRTtZQUNuRTtZQUNBLElBQUl0RCxNQUFNc0QsT0FBTyxDQUFDQyxRQUFRLENBQUMsdUJBQXVCdkQsTUFBTXNELE9BQU8sQ0FBQ0MsUUFBUSxDQUFDLFVBQVU7Z0JBQ2pGLE9BQU94RCxvQkFBb0IsQ0FBQyx3QkFBd0IsRUFBRUMsTUFBTXNELE9BQU8sQ0FBQyxDQUFDLEVBQUU7WUFDekU7WUFDQSxPQUFPdkQsb0JBQW9CLENBQUMsY0FBYyxFQUFFQyxNQUFNc0QsT0FBTyxDQUFDLENBQUMsRUFBRTtRQUMvRDtRQUVBLE9BQU92RCxvQkFBb0IseUJBQXlCO0lBQ3REO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbmFwLy4vc3JjL2FwcC9hcGkvc25hcC9yb3V0ZS50cz8wNWZlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCB7IE1pY3JvbGlua1NlcnZpY2UgfSBmcm9tICdAL2xpYi9zZXJ2aWNlcy9taWNyb2xpbmsnXG5pbXBvcnQgeyBJbWFnZVByb2Nlc3NvciB9IGZyb20gJ0AvbGliL3NlcnZpY2VzL2ltYWdlLXByb2Nlc3NvcidcbmltcG9ydCB7IEJyb3dzZXJNb2NrdXBTZXJ2aWNlIH0gZnJvbSAnQC9saWIvc2VydmljZXMvYnJvd3Nlci1tb2NrdXAnXG5pbXBvcnQgeyB2YWxpZGF0ZVNuYXBSZXF1ZXN0LCB2YWxpZGF0ZVNuYXBRdWVyeSwgcXVlcnlUb1JlcXVlc3QgfSBmcm9tICdAL2xpYi92YWxpZGF0aW9uJ1xuaW1wb3J0IHR5cGUgeyBTbmFwUmVzcG9uc2UsIFNjcmVlbnNob3RDb25maWcsIFN0eWxlQ29uZmlnIH0gZnJvbSAnQC9saWIvdHlwZXMnXG5cbmZ1bmN0aW9uIGNyZWF0ZUVycm9yUmVzcG9uc2UoZXJyb3I6IHN0cmluZywgc3RhdHVzID0gNDAwKTogTmV4dFJlc3BvbnNlIHtcbiAgY29uc3QgcmVzcG9uc2U6IFNuYXBSZXNwb25zZSA9IHtcbiAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICBlcnJvclxuICB9XG4gIFxuICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzcG9uc2UsIHsgc3RhdHVzIH0pXG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVN1Y2Nlc3NSZXNwb25zZShpbWFnZUJ1ZmZlcjogQnVmZmVyLCB1cmw6IHN0cmluZywgbWV0YWRhdGE6IGFueSk6IE5leHRSZXNwb25zZSB7XG4gIGNvbnN0IHJlc3BvbnNlOiBTbmFwUmVzcG9uc2UgPSB7XG4gICAgc3VjY2VzczogdHJ1ZSxcbiAgICBpbWFnZVVybDogYGRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCwke2ltYWdlQnVmZmVyLnRvU3RyaW5nKCdiYXNlNjQnKX1gLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcmlnaW5hbFVybDogdXJsLFxuICAgICAgcHJvY2Vzc2VkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgIGRpbWVuc2lvbnM6IG1ldGFkYXRhXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3BvbnNlKVxufVxuXG5hc3luYyBmdW5jdGlvbiBwcm9jZXNzU25hcHNob3QodXJsOiBzdHJpbmcsIHNjcmVlbnNob3RDb25maWc/OiBQYXJ0aWFsPFNjcmVlbnNob3RDb25maWc+LCBzdHlsZUNvbmZpZz86IFBhcnRpYWw8U3R5bGVDb25maWc+KTogUHJvbWlzZTx7IGJ1ZmZlcjogQnVmZmVyLCBtZXRhZGF0YTogYW55IH0+IHtcbiAgLy8gTWVyZ2Ugd2l0aCBkZWZhdWx0c1xuICBjb25zdCBmaW5hbFNjcmVlbnNob3RDb25maWc6IFNjcmVlbnNob3RDb25maWcgPSB7XG4gICAgLi4uTWljcm9saW5rU2VydmljZS5nZXREZWZhdWx0Q29uZmlnKCksXG4gICAgdXJsLFxuICAgIC4uLnNjcmVlbnNob3RDb25maWdcbiAgfVxuXG4gIGNvbnN0IGZpbmFsU3R5bGVDb25maWc6IFN0eWxlQ29uZmlnID0ge1xuICAgIC4uLkltYWdlUHJvY2Vzc29yLmdldERlZmF1bHRTdHlsZSgpLFxuICAgIC4uLnN0eWxlQ29uZmlnXG4gIH1cblxuICAvLyBPcHRpbWl6ZSB2aWV3cG9ydCBmb3IgZmluYWwgaW1hZ2Ugc2l6ZSBpZiBzcGVjaWZpZWRcbiAgLy8gVE9ETzogVGVtcG9yYXJpbHkgZGlzYWJsZWQgLSB1c2luZyBvcmlnaW5hbCBjb25maWdcbiAgLy8gY29uc3Qgb3B0aW1pemVkU2NyZWVuc2hvdENvbmZpZyA9IE1pY3JvbGlua1NlcnZpY2Uub3B0aW1pemVWaWV3cG9ydEZvckZpbmFsU2l6ZShcbiAgLy8gICBmaW5hbFNjcmVlbnNob3RDb25maWcsXG4gIC8vICAgZmluYWxTdHlsZUNvbmZpZy5maW5hbFNpemVcbiAgLy8gKVxuICBjb25zdCBvcHRpbWl6ZWRTY3JlZW5zaG90Q29uZmlnID0gZmluYWxTY3JlZW5zaG90Q29uZmlnXG5cbiAgLy8gRmV0Y2ggc2NyZWVuc2hvdCBmcm9tIE1pY3JvbGlua1xuICBjb25zdCBzY3JlZW5zaG90QnVmZmVyID0gYXdhaXQgTWljcm9saW5rU2VydmljZS5mZXRjaFNjcmVlbnNob3Qob3B0aW1pemVkU2NyZWVuc2hvdENvbmZpZylcbiAgXG4gIC8vIEFwcGx5IGJyb3dzZXIgbW9ja3VwIGlmIHNwZWNpZmllZFxuICBsZXQgcHJvY2Vzc2VkQnVmZmVyID0gc2NyZWVuc2hvdEJ1ZmZlclxuICBpZiAoZmluYWxTdHlsZUNvbmZpZy5icm93c2VyTW9ja3VwICE9PSAnbm9uZScpIHtcbiAgICBwcm9jZXNzZWRCdWZmZXIgPSBhd2FpdCBCcm93c2VyTW9ja3VwU2VydmljZS5hcHBseU1vY2t1cChwcm9jZXNzZWRCdWZmZXIsIGZpbmFsU3R5bGVDb25maWcuYnJvd3Nlck1vY2t1cClcbiAgfVxuICBcbiAgLy8gQXBwbHkgc3R5bGluZyAoYm9yZGVycywgbWFyZ2lucywgZ3JhZGllbnRzLCBzaGFkb3dzKVxuICBwcm9jZXNzZWRCdWZmZXIgPSBhd2FpdCBJbWFnZVByb2Nlc3Nvci5wcm9jZXNzU2NyZWVuc2hvdChwcm9jZXNzZWRCdWZmZXIsIGZpbmFsU3R5bGVDb25maWcpXG4gIFxuICAvLyBHZXQgZmluYWwgZGltZW5zaW9uc1xuICBjb25zdCBzaGFycCA9IChhd2FpdCBpbXBvcnQoJ3NoYXJwJykpLmRlZmF1bHRcbiAgY29uc3QgbWV0YWRhdGEgPSBhd2FpdCBzaGFycChwcm9jZXNzZWRCdWZmZXIpLm1ldGFkYXRhKClcbiAgXG4gIHJldHVybiB7XG4gICAgYnVmZmVyOiBwcm9jZXNzZWRCdWZmZXIsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIHdpZHRoOiBtZXRhZGF0YS53aWR0aCB8fCAwLFxuICAgICAgaGVpZ2h0OiBtZXRhZGF0YS5oZWlnaHQgfHwgMFxuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpXG4gICAgY29uc3QgcXVlcnlQYXJhbXMgPSBPYmplY3QuZnJvbUVudHJpZXMoc2VhcmNoUGFyYW1zLmVudHJpZXMoKSlcbiAgICBjb25zb2xlLmxvZygnUXVlcnkgcGFyYW1zIHJlY2VpdmVkOicsIHF1ZXJ5UGFyYW1zKVxuICAgIFxuICAgIGlmICghcXVlcnlQYXJhbXMudXJsKSB7XG4gICAgICByZXR1cm4gY3JlYXRlRXJyb3JSZXNwb25zZShcIk1pc3NpbmcgcmVxdWlyZWQgcGFyYW1ldGVyOiB1cmxcIilcbiAgICB9XG5cbiAgICAvLyBDbGVhbiB1cCBlbXB0eSBzdHJpbmcgcGFyYW1ldGVyc1xuICAgIGNvbnN0IGNsZWFuZWRQYXJhbXMgPSBPYmplY3QuZnJvbUVudHJpZXMoXG4gICAgICBPYmplY3QuZW50cmllcyhxdWVyeVBhcmFtcykuZmlsdGVyKChbXywgdmFsdWVdKSA9PiB2YWx1ZSAhPT0gJycpXG4gICAgKVxuXG4gICAgY29uc3QgdmFsaWRhdGVkUXVlcnkgPSB2YWxpZGF0ZVNuYXBRdWVyeShjbGVhbmVkUGFyYW1zKVxuICAgIGNvbnN0IHNuYXBSZXF1ZXN0ID0gcXVlcnlUb1JlcXVlc3QodmFsaWRhdGVkUXVlcnkpXG4gICAgXG4gICAgY29uc3QgeyBidWZmZXIsIG1ldGFkYXRhIH0gPSBhd2FpdCBwcm9jZXNzU25hcHNob3QoXG4gICAgICBzbmFwUmVxdWVzdC51cmwsXG4gICAgICBzbmFwUmVxdWVzdC5zY3JlZW5zaG90LFxuICAgICAgc25hcFJlcXVlc3Quc3R5bGVcbiAgICApXG4gICAgXG4gICAgcmV0dXJuIGNyZWF0ZVN1Y2Nlc3NSZXNwb25zZShidWZmZXIsIHNuYXBSZXF1ZXN0LnVybCwgbWV0YWRhdGEpXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignR0VUIC9hcGkvc25hcCBlcnJvcjonLCBlcnJvcilcbiAgICBcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgaWYgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ1pvZEVycm9yJykgfHwgZXJyb3IubmFtZSA9PT0gJ1pvZEVycm9yJykge1xuICAgICAgICByZXR1cm4gY3JlYXRlRXJyb3JSZXNwb25zZShgVmFsaWRhdGlvbiBlcnJvcjogJHtlcnJvci5tZXNzYWdlfWAsIDQwMClcbiAgICAgIH1cbiAgICAgIGlmIChlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdTY3JlZW5zaG90IGZldGNoIGZhaWxlZCcpKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKGBTY3JlZW5zaG90IGVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YCwgNTAzKVxuICAgICAgfVxuICAgICAgaWYgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ1Byb2Nlc3NpbmcgZXJyb3InKSB8fCBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdTaGFycCcpKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKGBJbWFnZSBwcm9jZXNzaW5nIGVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YCwgNTAwKVxuICAgICAgfVxuICAgICAgcmV0dXJuIGNyZWF0ZUVycm9yUmVzcG9uc2UoYFNlcnZlciBlcnJvcjogJHtlcnJvci5tZXNzYWdlfWAsIDUwMClcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGNyZWF0ZUVycm9yUmVzcG9uc2UoJ0ludGVybmFsIHNlcnZlciBlcnJvcicsIDUwMClcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuICAgIGNvbnN0IHZhbGlkYXRlZFJlcXVlc3QgPSB2YWxpZGF0ZVNuYXBSZXF1ZXN0KGJvZHkpXG4gICAgXG4gICAgY29uc3QgeyBidWZmZXIsIG1ldGFkYXRhIH0gPSBhd2FpdCBwcm9jZXNzU25hcHNob3QoXG4gICAgICB2YWxpZGF0ZWRSZXF1ZXN0LnVybCxcbiAgICAgIHZhbGlkYXRlZFJlcXVlc3Quc2NyZWVuc2hvdCxcbiAgICAgIHZhbGlkYXRlZFJlcXVlc3Quc3R5bGVcbiAgICApXG4gICAgXG4gICAgcmV0dXJuIGNyZWF0ZVN1Y2Nlc3NSZXNwb25zZShidWZmZXIsIHZhbGlkYXRlZFJlcXVlc3QudXJsLCBtZXRhZGF0YSlcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdQT1NUIC9hcGkvc25hcCBlcnJvcjonLCBlcnJvcilcbiAgICBcbiAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgaWYgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ1pvZEVycm9yJykgfHwgZXJyb3IubmFtZSA9PT0gJ1pvZEVycm9yJykge1xuICAgICAgICByZXR1cm4gY3JlYXRlRXJyb3JSZXNwb25zZShgVmFsaWRhdGlvbiBlcnJvcjogJHtlcnJvci5tZXNzYWdlfWAsIDQwMClcbiAgICAgIH1cbiAgICAgIGlmIChlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdTY3JlZW5zaG90IGZldGNoIGZhaWxlZCcpKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKGBTY3JlZW5zaG90IGVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YCwgNTAzKVxuICAgICAgfVxuICAgICAgaWYgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ1Byb2Nlc3NpbmcgZXJyb3InKSB8fCBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdTaGFycCcpKSB7XG4gICAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKGBJbWFnZSBwcm9jZXNzaW5nIGVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YCwgNTAwKVxuICAgICAgfVxuICAgICAgcmV0dXJuIGNyZWF0ZUVycm9yUmVzcG9uc2UoYFNlcnZlciBlcnJvcjogJHtlcnJvci5tZXNzYWdlfWAsIDUwMClcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGNyZWF0ZUVycm9yUmVzcG9uc2UoJ0ludGVybmFsIHNlcnZlciBlcnJvcicsIDUwMClcbiAgfVxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJNaWNyb2xpbmtTZXJ2aWNlIiwiSW1hZ2VQcm9jZXNzb3IiLCJCcm93c2VyTW9ja3VwU2VydmljZSIsInZhbGlkYXRlU25hcFJlcXVlc3QiLCJ2YWxpZGF0ZVNuYXBRdWVyeSIsInF1ZXJ5VG9SZXF1ZXN0IiwiY3JlYXRlRXJyb3JSZXNwb25zZSIsImVycm9yIiwic3RhdHVzIiwicmVzcG9uc2UiLCJzdWNjZXNzIiwianNvbiIsImNyZWF0ZVN1Y2Nlc3NSZXNwb25zZSIsImltYWdlQnVmZmVyIiwidXJsIiwibWV0YWRhdGEiLCJpbWFnZVVybCIsInRvU3RyaW5nIiwib3JpZ2luYWxVcmwiLCJwcm9jZXNzZWRBdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsImRpbWVuc2lvbnMiLCJwcm9jZXNzU25hcHNob3QiLCJzY3JlZW5zaG90Q29uZmlnIiwic3R5bGVDb25maWciLCJmaW5hbFNjcmVlbnNob3RDb25maWciLCJnZXREZWZhdWx0Q29uZmlnIiwiZmluYWxTdHlsZUNvbmZpZyIsImdldERlZmF1bHRTdHlsZSIsIm9wdGltaXplZFNjcmVlbnNob3RDb25maWciLCJzY3JlZW5zaG90QnVmZmVyIiwiZmV0Y2hTY3JlZW5zaG90IiwicHJvY2Vzc2VkQnVmZmVyIiwiYnJvd3Nlck1vY2t1cCIsImFwcGx5TW9ja3VwIiwicHJvY2Vzc1NjcmVlbnNob3QiLCJzaGFycCIsImRlZmF1bHQiLCJidWZmZXIiLCJ3aWR0aCIsImhlaWdodCIsIkdFVCIsInJlcXVlc3QiLCJzZWFyY2hQYXJhbXMiLCJVUkwiLCJxdWVyeVBhcmFtcyIsIk9iamVjdCIsImZyb21FbnRyaWVzIiwiZW50cmllcyIsImNvbnNvbGUiLCJsb2ciLCJjbGVhbmVkUGFyYW1zIiwiZmlsdGVyIiwiXyIsInZhbHVlIiwidmFsaWRhdGVkUXVlcnkiLCJzbmFwUmVxdWVzdCIsInNjcmVlbnNob3QiLCJzdHlsZSIsIkVycm9yIiwibWVzc2FnZSIsImluY2x1ZGVzIiwibmFtZSIsIlBPU1QiLCJib2R5IiwidmFsaWRhdGVkUmVxdWVzdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/snap/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/browser-mockup.ts":
/*!********************************************!*\
  !*** ./src/lib/services/browser-mockup.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BrowserMockupService: () => (/* binding */ BrowserMockupService)\n/* harmony export */ });\n/* harmony import */ var sharp__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sharp */ \"sharp\");\n/* harmony import */ var sharp__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(sharp__WEBPACK_IMPORTED_MODULE_0__);\n\nclass BrowserMockupService {\n    static{\n        this.MOCKUP_CONFIGS = {\n            safari: {\n                topBarHeight: 80,\n                borderRadius: 12,\n                backgroundColor: \"#f6f6f6\",\n                controlsColor: \"#ff5f56,#ffbd2e,#27ca3f\",\n                addressBarColor: \"#ffffff\",\n                addressBarHeight: 36,\n                titleBarHeight: 44\n            },\n            chrome: {\n                topBarHeight: 80,\n                borderRadius: 8,\n                backgroundColor: \"#f1f3f4\",\n                controlsColor: \"#ff5f56,#ffbd2e,#27ca3f\",\n                addressBarColor: \"#ffffff\",\n                addressBarHeight: 36,\n                titleBarHeight: 44\n            },\n            firefox: {\n                topBarHeight: 80,\n                borderRadius: 8,\n                backgroundColor: \"#f9f9fa\",\n                controlsColor: \"#ff5f56,#ffbd2e,#27ca3f\",\n                addressBarColor: \"#ffffff\",\n                addressBarHeight: 32,\n                titleBarHeight: 48\n            },\n            edge: {\n                topBarHeight: 80,\n                borderRadius: 8,\n                backgroundColor: \"#e5e5e5\",\n                controlsColor: \"#ff5f56,#ffbd2e,#27ca3f\",\n                addressBarColor: \"#ffffff\",\n                addressBarHeight: 34,\n                titleBarHeight: 46\n            }\n        };\n    }\n    static async applyMockup(imageBuffer, mockup) {\n        if (mockup === \"none\") {\n            return imageBuffer;\n        }\n        const config = this.MOCKUP_CONFIGS[mockup];\n        const image = sharp__WEBPACK_IMPORTED_MODULE_0___default()(imageBuffer);\n        const metadata = await image.metadata();\n        if (!metadata.width || !metadata.height) {\n            throw new Error(\"Invalid image dimensions for mockup\");\n        }\n        const mockupWidth = metadata.width + 20; // 10px padding on each side\n        const mockupHeight = metadata.height + config.topBarHeight + 20; // top bar + bottom padding\n        const mockupSvg = this.generateMockupSvg(mockupWidth, mockupHeight, config, mockup);\n        const mockupBuffer = Buffer.from(mockupSvg);\n        return sharp__WEBPACK_IMPORTED_MODULE_0___default()(mockupBuffer).composite([\n            {\n                input: imageBuffer,\n                left: 10,\n                top: config.topBarHeight + 10\n            }\n        ]).png().toBuffer();\n    }\n    static generateMockupSvg(width, height, config, browser) {\n        const controls = config.controlsColor.split(\",\");\n        return `\n      <svg width=\"${width}\" height=\"${height}\" xmlns=\"http://www.w3.org/2000/svg\">\n        <defs>\n          <linearGradient id=\"topBarGradient\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\n            <stop offset=\"0%\" style=\"stop-color:${config.backgroundColor};stop-opacity:1\" />\n            <stop offset=\"100%\" style=\"stop-color:#e0e0e0;stop-opacity:1\" />\n          </linearGradient>\n        </defs>\n        \n        <!-- Main container with rounded corners -->\n        <rect width=\"${width}\" height=\"${height}\" rx=\"${config.borderRadius}\" ry=\"${config.borderRadius}\" \n              fill=\"${config.backgroundColor}\" stroke=\"#d0d0d0\" stroke-width=\"1\"/>\n        \n        <!-- Top bar -->\n        <rect x=\"1\" y=\"1\" width=\"${width - 2}\" height=\"${config.titleBarHeight}\" \n              rx=\"${config.borderRadius}\" ry=\"${config.borderRadius}\" fill=\"url(#topBarGradient)\"/>\n        \n        <!-- Traffic lights -->\n        <circle cx=\"20\" cy=\"${config.titleBarHeight / 2}\" r=\"6\" fill=\"${controls[0]}\"/>\n        <circle cx=\"40\" cy=\"${config.titleBarHeight / 2}\" r=\"6\" fill=\"${controls[1]}\"/>\n        <circle cx=\"60\" cy=\"${config.titleBarHeight / 2}\" r=\"6\" fill=\"${controls[2]}\"/>\n        \n        <!-- Address bar -->\n        <rect x=\"90\" y=\"${(config.titleBarHeight - config.addressBarHeight) / 2}\" \n              width=\"${width - 120}\" height=\"${config.addressBarHeight}\" \n              rx=\"16\" ry=\"16\" fill=\"${config.addressBarColor}\" stroke=\"#d0d0d0\" stroke-width=\"1\"/>\n        \n        <!-- Address bar icon -->\n        <circle cx=\"105\" cy=\"${config.titleBarHeight / 2}\" r=\"8\" fill=\"#00c851\" opacity=\"0.7\"/>\n        \n        <!-- Separator line -->\n        <line x1=\"10\" y1=\"${config.titleBarHeight}\" x2=\"${width - 10}\" y2=\"${config.titleBarHeight}\" \n              stroke=\"#d0d0d0\" stroke-width=\"1\"/>\n      </svg>\n    `;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxFQUFFLENBQUM7Ozt3QkFHNUQsRUFBRSxDQUFDcEIsT0FBT1AsY0FBYyxHQUFHTyxPQUFPUixnQkFBZ0IsSUFBSSxFQUFFO3FCQUMzRCxFQUFFVyxRQUFRLElBQUksVUFBVSxFQUFFSCxPQUFPUixnQkFBZ0IsQ0FBQztvQ0FDbkMsRUFBRVEsT0FBT1QsZUFBZSxDQUFDOzs7NkJBR2hDLEVBQUVTLE9BQU9QLGNBQWMsR0FBRyxFQUFFOzs7MEJBRy9CLEVBQUVPLE9BQU9QLGNBQWMsQ0FBQyxNQUFNLEVBQUVVLFFBQVEsR0FBRyxNQUFNLEVBQUVILE9BQU9QLGNBQWMsQ0FBQzs7O0lBRy9GLENBQUM7SUFDSDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc25hcC8uL3NyYy9saWIvc2VydmljZXMvYnJvd3Nlci1tb2NrdXAudHM/MDVlMCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgc2hhcnAgZnJvbSAnc2hhcnAnO1xuaW1wb3J0IHR5cGUgeyBCcm93c2VyTW9ja3VwIH0gZnJvbSAnLi4vdHlwZXMuanMnO1xuXG5leHBvcnQgY2xhc3MgQnJvd3Nlck1vY2t1cFNlcnZpY2Uge1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBNT0NLVVBfQ09ORklHUyA9IHtcbiAgICBzYWZhcmk6IHtcbiAgICAgIHRvcEJhckhlaWdodDogODAsXG4gICAgICBib3JkZXJSYWRpdXM6IDEyLFxuICAgICAgYmFja2dyb3VuZENvbG9yOiAnI2Y2ZjZmNicsXG4gICAgICBjb250cm9sc0NvbG9yOiAnI2ZmNWY1NiwjZmZiZDJlLCMyN2NhM2YnLFxuICAgICAgYWRkcmVzc0JhckNvbG9yOiAnI2ZmZmZmZicsXG4gICAgICBhZGRyZXNzQmFySGVpZ2h0OiAzNixcbiAgICAgIHRpdGxlQmFySGVpZ2h0OiA0NFxuICAgIH0sXG4gICAgY2hyb21lOiB7XG4gICAgICB0b3BCYXJIZWlnaHQ6IDgwLFxuICAgICAgYm9yZGVyUmFkaXVzOiA4LFxuICAgICAgYmFja2dyb3VuZENvbG9yOiAnI2YxZjNmNCcsXG4gICAgICBjb250cm9sc0NvbG9yOiAnI2ZmNWY1NiwjZmZiZDJlLCMyN2NhM2YnLFxuICAgICAgYWRkcmVzc0JhckNvbG9yOiAnI2ZmZmZmZicsXG4gICAgICBhZGRyZXNzQmFySGVpZ2h0OiAzNixcbiAgICAgIHRpdGxlQmFySGVpZ2h0OiA0NFxuICAgIH0sXG4gICAgZmlyZWZveDoge1xuICAgICAgdG9wQmFySGVpZ2h0OiA4MCxcbiAgICAgIGJvcmRlclJhZGl1czogOCxcbiAgICAgIGJhY2tncm91bmRDb2xvcjogJyNmOWY5ZmEnLFxuICAgICAgY29udHJvbHNDb2xvcjogJyNmZjVmNTYsI2ZmYmQyZSwjMjdjYTNmJyxcbiAgICAgIGFkZHJlc3NCYXJDb2xvcjogJyNmZmZmZmYnLFxuICAgICAgYWRkcmVzc0JhckhlaWdodDogMzIsXG4gICAgICB0aXRsZUJhckhlaWdodDogNDhcbiAgICB9LFxuICAgIGVkZ2U6IHtcbiAgICAgIHRvcEJhckhlaWdodDogODAsXG4gICAgICBib3JkZXJSYWRpdXM6IDgsXG4gICAgICBiYWNrZ3JvdW5kQ29sb3I6ICcjZTVlNWU1JyxcbiAgICAgIGNvbnRyb2xzQ29sb3I6ICcjZmY1ZjU2LCNmZmJkMmUsIzI3Y2EzZicsXG4gICAgICBhZGRyZXNzQmFyQ29sb3I6ICcjZmZmZmZmJyxcbiAgICAgIGFkZHJlc3NCYXJIZWlnaHQ6IDM0LFxuICAgICAgdGl0bGVCYXJIZWlnaHQ6IDQ2XG4gICAgfVxuICB9O1xuXG4gIHN0YXRpYyBhc3luYyBhcHBseU1vY2t1cChpbWFnZUJ1ZmZlcjogQnVmZmVyLCBtb2NrdXA6IEJyb3dzZXJNb2NrdXApOiBQcm9taXNlPEJ1ZmZlcj4ge1xuICAgIGlmIChtb2NrdXAgPT09ICdub25lJykge1xuICAgICAgcmV0dXJuIGltYWdlQnVmZmVyO1xuICAgIH1cblxuICAgIGNvbnN0IGNvbmZpZyA9IHRoaXMuTU9DS1VQX0NPTkZJR1NbbW9ja3VwXTtcbiAgICBjb25zdCBpbWFnZSA9IHNoYXJwKGltYWdlQnVmZmVyKTtcbiAgICBjb25zdCBtZXRhZGF0YSA9IGF3YWl0IGltYWdlLm1ldGFkYXRhKCk7XG5cbiAgICBpZiAoIW1ldGFkYXRhLndpZHRoIHx8ICFtZXRhZGF0YS5oZWlnaHQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBpbWFnZSBkaW1lbnNpb25zIGZvciBtb2NrdXAnKTtcbiAgICB9XG5cbiAgICBjb25zdCBtb2NrdXBXaWR0aCA9IG1ldGFkYXRhLndpZHRoICsgMjA7IC8vIDEwcHggcGFkZGluZyBvbiBlYWNoIHNpZGVcbiAgICBjb25zdCBtb2NrdXBIZWlnaHQgPSBtZXRhZGF0YS5oZWlnaHQgKyBjb25maWcudG9wQmFySGVpZ2h0ICsgMjA7IC8vIHRvcCBiYXIgKyBib3R0b20gcGFkZGluZ1xuXG4gICAgY29uc3QgbW9ja3VwU3ZnID0gdGhpcy5nZW5lcmF0ZU1vY2t1cFN2Zyhtb2NrdXBXaWR0aCwgbW9ja3VwSGVpZ2h0LCBjb25maWcsIG1vY2t1cCk7XG4gICAgY29uc3QgbW9ja3VwQnVmZmVyID0gQnVmZmVyLmZyb20obW9ja3VwU3ZnKTtcblxuICAgIHJldHVybiBzaGFycChtb2NrdXBCdWZmZXIpXG4gICAgICAuY29tcG9zaXRlKFtcbiAgICAgICAge1xuICAgICAgICAgIGlucHV0OiBpbWFnZUJ1ZmZlcixcbiAgICAgICAgICBsZWZ0OiAxMCxcbiAgICAgICAgICB0b3A6IGNvbmZpZy50b3BCYXJIZWlnaHQgKyAxMFxuICAgICAgICB9XG4gICAgICBdKVxuICAgICAgLnBuZygpXG4gICAgICAudG9CdWZmZXIoKTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGdlbmVyYXRlTW9ja3VwU3ZnKFxuICAgIHdpZHRoOiBudW1iZXIsXG4gICAgaGVpZ2h0OiBudW1iZXIsXG4gICAgY29uZmlnOiB0eXBlb2YgQnJvd3Nlck1vY2t1cFNlcnZpY2UuTU9DS1VQX0NPTkZJR1Muc2FmYXJpLFxuICAgIGJyb3dzZXI6IEV4Y2x1ZGU8QnJvd3Nlck1vY2t1cCwgJ25vbmUnPlxuICApOiBzdHJpbmcge1xuICAgIGNvbnN0IGNvbnRyb2xzID0gY29uZmlnLmNvbnRyb2xzQ29sb3Iuc3BsaXQoJywnKTtcbiAgICBcbiAgICByZXR1cm4gYFxuICAgICAgPHN2ZyB3aWR0aD1cIiR7d2lkdGh9XCIgaGVpZ2h0PVwiJHtoZWlnaHR9XCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPlxuICAgICAgICA8ZGVmcz5cbiAgICAgICAgICA8bGluZWFyR3JhZGllbnQgaWQ9XCJ0b3BCYXJHcmFkaWVudFwiIHgxPVwiMCVcIiB5MT1cIjAlXCIgeDI9XCIwJVwiIHkyPVwiMTAwJVwiPlxuICAgICAgICAgICAgPHN0b3Agb2Zmc2V0PVwiMCVcIiBzdHlsZT1cInN0b3AtY29sb3I6JHtjb25maWcuYmFja2dyb3VuZENvbG9yfTtzdG9wLW9wYWNpdHk6MVwiIC8+XG4gICAgICAgICAgICA8c3RvcCBvZmZzZXQ9XCIxMDAlXCIgc3R5bGU9XCJzdG9wLWNvbG9yOiNlMGUwZTA7c3RvcC1vcGFjaXR5OjFcIiAvPlxuICAgICAgICAgIDwvbGluZWFyR3JhZGllbnQ+XG4gICAgICAgIDwvZGVmcz5cbiAgICAgICAgXG4gICAgICAgIDwhLS0gTWFpbiBjb250YWluZXIgd2l0aCByb3VuZGVkIGNvcm5lcnMgLS0+XG4gICAgICAgIDxyZWN0IHdpZHRoPVwiJHt3aWR0aH1cIiBoZWlnaHQ9XCIke2hlaWdodH1cIiByeD1cIiR7Y29uZmlnLmJvcmRlclJhZGl1c31cIiByeT1cIiR7Y29uZmlnLmJvcmRlclJhZGl1c31cIiBcbiAgICAgICAgICAgICAgZmlsbD1cIiR7Y29uZmlnLmJhY2tncm91bmRDb2xvcn1cIiBzdHJva2U9XCIjZDBkMGQwXCIgc3Ryb2tlLXdpZHRoPVwiMVwiLz5cbiAgICAgICAgXG4gICAgICAgIDwhLS0gVG9wIGJhciAtLT5cbiAgICAgICAgPHJlY3QgeD1cIjFcIiB5PVwiMVwiIHdpZHRoPVwiJHt3aWR0aCAtIDJ9XCIgaGVpZ2h0PVwiJHtjb25maWcudGl0bGVCYXJIZWlnaHR9XCIgXG4gICAgICAgICAgICAgIHJ4PVwiJHtjb25maWcuYm9yZGVyUmFkaXVzfVwiIHJ5PVwiJHtjb25maWcuYm9yZGVyUmFkaXVzfVwiIGZpbGw9XCJ1cmwoI3RvcEJhckdyYWRpZW50KVwiLz5cbiAgICAgICAgXG4gICAgICAgIDwhLS0gVHJhZmZpYyBsaWdodHMgLS0+XG4gICAgICAgIDxjaXJjbGUgY3g9XCIyMFwiIGN5PVwiJHtjb25maWcudGl0bGVCYXJIZWlnaHQgLyAyfVwiIHI9XCI2XCIgZmlsbD1cIiR7Y29udHJvbHNbMF19XCIvPlxuICAgICAgICA8Y2lyY2xlIGN4PVwiNDBcIiBjeT1cIiR7Y29uZmlnLnRpdGxlQmFySGVpZ2h0IC8gMn1cIiByPVwiNlwiIGZpbGw9XCIke2NvbnRyb2xzWzFdfVwiLz5cbiAgICAgICAgPGNpcmNsZSBjeD1cIjYwXCIgY3k9XCIke2NvbmZpZy50aXRsZUJhckhlaWdodCAvIDJ9XCIgcj1cIjZcIiBmaWxsPVwiJHtjb250cm9sc1syXX1cIi8+XG4gICAgICAgIFxuICAgICAgICA8IS0tIEFkZHJlc3MgYmFyIC0tPlxuICAgICAgICA8cmVjdCB4PVwiOTBcIiB5PVwiJHsoY29uZmlnLnRpdGxlQmFySGVpZ2h0IC0gY29uZmlnLmFkZHJlc3NCYXJIZWlnaHQpIC8gMn1cIiBcbiAgICAgICAgICAgICAgd2lkdGg9XCIke3dpZHRoIC0gMTIwfVwiIGhlaWdodD1cIiR7Y29uZmlnLmFkZHJlc3NCYXJIZWlnaHR9XCIgXG4gICAgICAgICAgICAgIHJ4PVwiMTZcIiByeT1cIjE2XCIgZmlsbD1cIiR7Y29uZmlnLmFkZHJlc3NCYXJDb2xvcn1cIiBzdHJva2U9XCIjZDBkMGQwXCIgc3Ryb2tlLXdpZHRoPVwiMVwiLz5cbiAgICAgICAgXG4gICAgICAgIDwhLS0gQWRkcmVzcyBiYXIgaWNvbiAtLT5cbiAgICAgICAgPGNpcmNsZSBjeD1cIjEwNVwiIGN5PVwiJHtjb25maWcudGl0bGVCYXJIZWlnaHQgLyAyfVwiIHI9XCI4XCIgZmlsbD1cIiMwMGM4NTFcIiBvcGFjaXR5PVwiMC43XCIvPlxuICAgICAgICBcbiAgICAgICAgPCEtLSBTZXBhcmF0b3IgbGluZSAtLT5cbiAgICAgICAgPGxpbmUgeDE9XCIxMFwiIHkxPVwiJHtjb25maWcudGl0bGVCYXJIZWlnaHR9XCIgeDI9XCIke3dpZHRoIC0gMTB9XCIgeTI9XCIke2NvbmZpZy50aXRsZUJhckhlaWdodH1cIiBcbiAgICAgICAgICAgICAgc3Ryb2tlPVwiI2QwZDBkMFwiIHN0cm9rZS13aWR0aD1cIjFcIi8+XG4gICAgICA8L3N2Zz5cbiAgICBgO1xuICB9XG59Il0sIm5hbWVzIjpbInNoYXJwIiwiQnJvd3Nlck1vY2t1cFNlcnZpY2UiLCJNT0NLVVBfQ09ORklHUyIsInNhZmFyaSIsInRvcEJhckhlaWdodCIsImJvcmRlclJhZGl1cyIsImJhY2tncm91bmRDb2xvciIsImNvbnRyb2xzQ29sb3IiLCJhZGRyZXNzQmFyQ29sb3IiLCJhZGRyZXNzQmFySGVpZ2h0IiwidGl0bGVCYXJIZWlnaHQiLCJjaHJvbWUiLCJmaXJlZm94IiwiZWRnZSIsImFwcGx5TW9ja3VwIiwiaW1hZ2VCdWZmZXIiLCJtb2NrdXAiLCJjb25maWciLCJpbWFnZSIsIm1ldGFkYXRhIiwid2lkdGgiLCJoZWlnaHQiLCJFcnJvciIsIm1vY2t1cFdpZHRoIiwibW9ja3VwSGVpZ2h0IiwibW9ja3VwU3ZnIiwiZ2VuZXJhdGVNb2NrdXBTdmciLCJtb2NrdXBCdWZmZXIiLCJCdWZmZXIiLCJmcm9tIiwiY29tcG9zaXRlIiwiaW5wdXQiLCJsZWZ0IiwidG9wIiwicG5nIiwidG9CdWZmZXIiLCJicm93c2VyIiwiY29udHJvbHMiLCJzcGxpdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/browser-mockup.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/image-processor.ts":
/*!*********************************************!*\
  !*** ./src/lib/services/image-processor.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ImageProcessor: () => (/* binding */ ImageProcessor)\n/* harmony export */ });\n/* harmony import */ var sharp__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sharp */ \"sharp\");\n/* harmony import */ var sharp__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(sharp__WEBPACK_IMPORTED_MODULE_0__);\n\nclass ImageProcessor {\n    static{\n        this.GRADIENT_ANGLES = {\n            \"to-r\": 90,\n            \"to-l\": 270,\n            \"to-t\": 0,\n            \"to-b\": 180,\n            \"to-br\": 135,\n            \"to-bl\": 225,\n            \"to-tr\": 45,\n            \"to-tl\": 315\n        };\n    }\n    static async processScreenshot(imageBuffer, style) {\n        const image = sharp__WEBPACK_IMPORTED_MODULE_0___default()(imageBuffer);\n        const metadata = await image.metadata();\n        if (!metadata.width || !metadata.height) {\n            throw new Error(\"Invalid image metadata\");\n        }\n        let processed = image;\n        if (style.borderRadius > 0) {\n            processed = await this.applyBorderRadius(processed, style.borderRadius, metadata.width, metadata.height);\n        }\n        if (style.margin > 0 || style.background.type !== \"solid\" || style.background.color !== \"transparent\") {\n            processed = await this.applyBackgroundAndMargin(processed, style.background, style.margin, metadata.width, metadata.height);\n        }\n        if (style.shadow.enabled) {\n            processed = await this.applyShadow(processed, style.shadow);\n        }\n        // Apply final size as the very last step to avoid dimension conflicts\n        // TODO: Temporarily disabled due to compositing issues\n        // if (style.finalSize) {\n        //   processed = await this.applyFinalSize(processed, style.finalSize);\n        // }\n        return processed.png().toBuffer();\n    }\n    static async applyBorderRadius(image, radius, width, height) {\n        // Get current image dimensions in case they've changed\n        const metadata = await image.metadata();\n        const currentWidth = metadata.width || width;\n        const currentHeight = metadata.height || height;\n        const mask = Buffer.from(`<svg width=\"${currentWidth}\" height=\"${currentHeight}\">\n        <rect x=\"0\" y=\"0\" width=\"${currentWidth}\" height=\"${currentHeight}\" rx=\"${radius}\" ry=\"${radius}\" fill=\"white\"/>\n      </svg>`);\n        return image.composite([\n            {\n                input: mask,\n                blend: \"dest-in\"\n            }\n        ]);\n    }\n    static async applyBackgroundAndMargin(image, background, margin, originalWidth, originalHeight) {\n        // Get current image dimensions in case they've changed\n        const metadata = await image.metadata();\n        const currentWidth = metadata.width || originalWidth;\n        const currentHeight = metadata.height || originalHeight;\n        const newWidth = currentWidth + margin * 2;\n        const newHeight = currentHeight + margin * 2;\n        let backgroundBuffer;\n        if (background.type === \"solid\") {\n            backgroundBuffer = await this.createSolidBackground(newWidth, newHeight, background.color);\n        } else {\n            backgroundBuffer = await this.createGradientBackground(newWidth, newHeight, background);\n        }\n        return sharp__WEBPACK_IMPORTED_MODULE_0___default()(backgroundBuffer).composite([\n            {\n                input: await image.toBuffer(),\n                left: margin,\n                top: margin\n            }\n        ]);\n    }\n    static async createSolidBackground(width, height, color) {\n        return sharp__WEBPACK_IMPORTED_MODULE_0___default()({\n            create: {\n                width,\n                height,\n                channels: 4,\n                background: color\n            }\n        }).png().toBuffer();\n    }\n    static async createGradientBackground(width, height, gradient) {\n        const angle = this.GRADIENT_ANGLES[gradient.direction];\n        const stops = gradient.colors.map(({ color, position = 50 })=>`<stop offset=\"${position}%\" stop-color=\"${color}\"/>`).join(\"\");\n        const svg = `\n      <svg width=\"${width}\" height=\"${height}\" xmlns=\"http://www.w3.org/2000/svg\">\n        <defs>\n          <linearGradient id=\"grad\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\" gradientTransform=\"rotate(${angle} 0.5 0.5)\">\n            ${stops}\n          </linearGradient>\n        </defs>\n        <rect width=\"100%\" height=\"100%\" fill=\"url(#grad)\"/>\n      </svg>\n    `;\n        return Buffer.from(svg);\n    }\n    static async applyShadow(image, shadow) {\n        const metadata = await image.metadata();\n        if (!metadata.width || !metadata.height) {\n            throw new Error(\"Cannot apply shadow to image without dimensions\");\n        }\n        const shadowWidth = metadata.width + Math.abs(shadow.offsetX) + shadow.blur * 2;\n        const shadowHeight = metadata.height + Math.abs(shadow.offsetY) + shadow.blur * 2;\n        const shadowSvg = `\n      <svg width=\"${shadowWidth}\" height=\"${shadowHeight}\">\n        <defs>\n          <filter id=\"shadow\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n            <feGaussianBlur in=\"SourceGraphic\" stdDeviation=\"${shadow.blur}\"/>\n            <feOffset dx=\"${shadow.offsetX}\" dy=\"${shadow.offsetY}\" result=\"offset\"/>\n            <feFlood flood-color=\"${shadow.color}\" flood-opacity=\"${shadow.opacity}\"/>\n            <feComposite in=\"SourceGraphic\" operator=\"over\"/>\n          </filter>\n        </defs>\n        <rect width=\"100%\" height=\"100%\" fill=\"transparent\"/>\n      </svg>\n    `;\n        const shadowBuffer = Buffer.from(shadowSvg);\n        const baseX = Math.max(0, -shadow.offsetX) + shadow.blur;\n        const baseY = Math.max(0, -shadow.offsetY) + shadow.blur;\n        return sharp__WEBPACK_IMPORTED_MODULE_0___default()({\n            create: {\n                width: shadowWidth,\n                height: shadowHeight,\n                channels: 4,\n                background: {\n                    r: 0,\n                    g: 0,\n                    b: 0,\n                    alpha: 0\n                }\n            }\n        }).composite([\n            {\n                input: shadowBuffer,\n                blend: \"multiply\"\n            },\n            {\n                input: await image.toBuffer(),\n                left: baseX,\n                top: baseY\n            }\n        ]);\n    }\n    static async applyFinalSize(image, finalSize) {\n        const metadata = await image.metadata();\n        if (!metadata.width || !metadata.height) {\n            throw new Error(\"Cannot apply final size to image without dimensions\");\n        }\n        let targetWidth = finalSize.width;\n        let targetHeight = finalSize.height;\n        if (finalSize.aspectRatio) {\n            const [ratioW, ratioH] = finalSize.aspectRatio.split(\":\").map(Number);\n            const ratio = ratioW / ratioH;\n            if (finalSize.width && !finalSize.height) {\n                targetHeight = Math.round(finalSize.width / ratio);\n            } else if (finalSize.height && !finalSize.width) {\n                targetWidth = Math.round(finalSize.height * ratio);\n            } else if (!finalSize.width && !finalSize.height) {\n                const currentRatio = metadata.width / metadata.height;\n                if (ratio > currentRatio) {\n                    targetWidth = metadata.width;\n                    targetHeight = Math.round(metadata.width / ratio);\n                } else {\n                    targetHeight = metadata.height;\n                    targetWidth = Math.round(metadata.height * ratio);\n                }\n            }\n        }\n        if (!targetWidth && !targetHeight) {\n            return image;\n        }\n        let resizeOptions = {\n            fit: finalSize.maintainAspectRatio !== false ? \"inside\" : \"fill\",\n            withoutEnlargement: false\n        };\n        if (targetWidth && targetHeight) {\n            return image.resize(targetWidth, targetHeight, resizeOptions);\n        } else if (targetWidth) {\n            return image.resize(targetWidth, undefined, resizeOptions);\n        } else if (targetHeight) {\n            return image.resize(undefined, targetHeight, resizeOptions);\n        }\n        return image;\n    }\n    static getDefaultStyle() {\n        return {\n            borderRadius: 8,\n            margin: 32,\n            background: {\n                type: \"gradient\",\n                direction: \"to-br\",\n                colors: [\n                    {\n                        color: \"#667eea\",\n                        position: 0\n                    },\n                    {\n                        color: \"#764ba2\",\n                        position: 100\n                    }\n                ]\n            },\n            browserMockup: \"none\",\n            shadow: {\n                enabled: true,\n                blur: 20,\n                offsetX: 0,\n                offsetY: 10,\n                color: \"#000000\",\n                opacity: 0.15\n            }\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3NlcnZpY2VzL2ltYWdlLXByb2Nlc3Nvci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBMEI7QUFHbkIsTUFBTUM7O2FBQ2FDLGtCQUFxRDtZQUMzRSxRQUFRO1lBQ1IsUUFBUTtZQUNSLFFBQVE7WUFDUixRQUFRO1lBQ1IsU0FBUztZQUNULFNBQVM7WUFDVCxTQUFTO1lBQ1QsU0FBUztRQUNYOztJQUVBLGFBQWFDLGtCQUFrQkMsV0FBbUIsRUFBRUMsS0FBa0IsRUFBbUI7UUFDdkYsTUFBTUMsUUFBUU4sNENBQUtBLENBQUNJO1FBQ3BCLE1BQU1HLFdBQVcsTUFBTUQsTUFBTUMsUUFBUTtRQUVyQyxJQUFJLENBQUNBLFNBQVNDLEtBQUssSUFBSSxDQUFDRCxTQUFTRSxNQUFNLEVBQUU7WUFDdkMsTUFBTSxJQUFJQyxNQUFNO1FBQ2xCO1FBRUEsSUFBSUMsWUFBWUw7UUFFaEIsSUFBSUQsTUFBTU8sWUFBWSxHQUFHLEdBQUc7WUFDMUJELFlBQVksTUFBTSxJQUFJLENBQUNFLGlCQUFpQixDQUFDRixXQUFXTixNQUFNTyxZQUFZLEVBQUVMLFNBQVNDLEtBQUssRUFBRUQsU0FBU0UsTUFBTTtRQUN6RztRQUVBLElBQUlKLE1BQU1TLE1BQU0sR0FBRyxLQUFLVCxNQUFNVSxVQUFVLENBQUNDLElBQUksS0FBSyxXQUFXWCxNQUFNVSxVQUFVLENBQUNFLEtBQUssS0FBSyxlQUFlO1lBQ3JHTixZQUFZLE1BQU0sSUFBSSxDQUFDTyx3QkFBd0IsQ0FDN0NQLFdBQ0FOLE1BQU1VLFVBQVUsRUFDaEJWLE1BQU1TLE1BQU0sRUFDWlAsU0FBU0MsS0FBSyxFQUNkRCxTQUFTRSxNQUFNO1FBRW5CO1FBRUEsSUFBSUosTUFBTWMsTUFBTSxDQUFDQyxPQUFPLEVBQUU7WUFDeEJULFlBQVksTUFBTSxJQUFJLENBQUNVLFdBQVcsQ0FBQ1YsV0FBV04sTUFBTWMsTUFBTTtRQUM1RDtRQUVBLHNFQUFzRTtRQUN0RSx1REFBdUQ7UUFDdkQseUJBQXlCO1FBQ3pC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QUFDUCxlQUFlLENBQUNDLGNBQWM7WUFDakMsT0FBT25FO1FBQ1Q7UUFFQSxJQUFJNEUsZ0JBQXFDO1lBQ3ZDQyxLQUFLWixVQUFVYSxtQkFBbUIsS0FBSyxRQUFRLFdBQVc7WUFDMURDLG9CQUFvQjtRQUN0QjtRQUVBLElBQUliLGVBQWVDLGNBQWM7WUFDL0IsT0FBT25FLE1BQU1nRixNQUFNLENBQUNkLGFBQWFDLGNBQWNTO1FBQ2pELE9BQU8sSUFBSVYsYUFBYTtZQUN0QixPQUFPbEUsTUFBTWdGLE1BQU0sQ0FBQ2QsYUFBYWUsV0FBV0w7UUFDOUMsT0FBTyxJQUFJVCxjQUFjO1lBQ3ZCLE9BQU9uRSxNQUFNZ0YsTUFBTSxDQUFDQyxXQUFXZCxjQUFjUztRQUMvQztRQUVBLE9BQU81RTtJQUNUO0lBRUEsT0FBT2tGLGtCQUErQjtRQUNwQyxPQUFPO1lBQ0w1RSxjQUFjO1lBQ2RFLFFBQVE7WUFDUkMsWUFBWTtnQkFDVkMsTUFBTTtnQkFDTjhCLFdBQVc7Z0JBQ1hFLFFBQVE7b0JBQ047d0JBQUUvQixPQUFPO3dCQUFXaUMsVUFBVTtvQkFBRTtvQkFDaEM7d0JBQUVqQyxPQUFPO3dCQUFXaUMsVUFBVTtvQkFBSTtpQkFDbkM7WUFDSDtZQUNBdUMsZUFBZTtZQUNmdEUsUUFBUTtnQkFDTkMsU0FBUztnQkFDVHFDLE1BQU07Z0JBQ05ELFNBQVM7Z0JBQ1RHLFNBQVM7Z0JBQ1QxQyxPQUFPO2dCQUNQNEMsU0FBUztZQUNYO1FBQ0Y7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc25hcC8uL3NyYy9saWIvc2VydmljZXMvaW1hZ2UtcHJvY2Vzc29yLnRzP2Y2MDEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHNoYXJwIGZyb20gJ3NoYXJwJztcbmltcG9ydCB0eXBlIHsgU3R5bGVDb25maWcsIEJhY2tncm91bmRTdHlsZSwgR3JhZGllbnREaXJlY3Rpb24sIEZpbmFsSW1hZ2VTaXplIH0gZnJvbSAnLi4vdHlwZXMuanMnO1xuXG5leHBvcnQgY2xhc3MgSW1hZ2VQcm9jZXNzb3Ige1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBHUkFESUVOVF9BTkdMRVM6IFJlY29yZDxHcmFkaWVudERpcmVjdGlvbiwgbnVtYmVyPiA9IHtcbiAgICAndG8tcic6IDkwLFxuICAgICd0by1sJzogMjcwLFxuICAgICd0by10JzogMCxcbiAgICAndG8tYic6IDE4MCxcbiAgICAndG8tYnInOiAxMzUsXG4gICAgJ3RvLWJsJzogMjI1LFxuICAgICd0by10cic6IDQ1LFxuICAgICd0by10bCc6IDMxNSxcbiAgfTtcblxuICBzdGF0aWMgYXN5bmMgcHJvY2Vzc1NjcmVlbnNob3QoaW1hZ2VCdWZmZXI6IEJ1ZmZlciwgc3R5bGU6IFN0eWxlQ29uZmlnKTogUHJvbWlzZTxCdWZmZXI+IHtcbiAgICBjb25zdCBpbWFnZSA9IHNoYXJwKGltYWdlQnVmZmVyKTtcbiAgICBjb25zdCBtZXRhZGF0YSA9IGF3YWl0IGltYWdlLm1ldGFkYXRhKCk7XG4gICAgXG4gICAgaWYgKCFtZXRhZGF0YS53aWR0aCB8fCAhbWV0YWRhdGEuaGVpZ2h0KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgaW1hZ2UgbWV0YWRhdGEnKTtcbiAgICB9XG5cbiAgICBsZXQgcHJvY2Vzc2VkID0gaW1hZ2U7XG5cbiAgICBpZiAoc3R5bGUuYm9yZGVyUmFkaXVzID4gMCkge1xuICAgICAgcHJvY2Vzc2VkID0gYXdhaXQgdGhpcy5hcHBseUJvcmRlclJhZGl1cyhwcm9jZXNzZWQsIHN0eWxlLmJvcmRlclJhZGl1cywgbWV0YWRhdGEud2lkdGgsIG1ldGFkYXRhLmhlaWdodCk7XG4gICAgfVxuXG4gICAgaWYgKHN0eWxlLm1hcmdpbiA+IDAgfHwgc3R5bGUuYmFja2dyb3VuZC50eXBlICE9PSAnc29saWQnIHx8IHN0eWxlLmJhY2tncm91bmQuY29sb3IgIT09ICd0cmFuc3BhcmVudCcpIHtcbiAgICAgIHByb2Nlc3NlZCA9IGF3YWl0IHRoaXMuYXBwbHlCYWNrZ3JvdW5kQW5kTWFyZ2luKFxuICAgICAgICBwcm9jZXNzZWQsXG4gICAgICAgIHN0eWxlLmJhY2tncm91bmQsXG4gICAgICAgIHN0eWxlLm1hcmdpbixcbiAgICAgICAgbWV0YWRhdGEud2lkdGgsXG4gICAgICAgIG1ldGFkYXRhLmhlaWdodFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoc3R5bGUuc2hhZG93LmVuYWJsZWQpIHtcbiAgICAgIHByb2Nlc3NlZCA9IGF3YWl0IHRoaXMuYXBwbHlTaGFkb3cocHJvY2Vzc2VkLCBzdHlsZS5zaGFkb3cpO1xuICAgIH1cblxuICAgIC8vIEFwcGx5IGZpbmFsIHNpemUgYXMgdGhlIHZlcnkgbGFzdCBzdGVwIHRvIGF2b2lkIGRpbWVuc2lvbiBjb25mbGljdHNcbiAgICAvLyBUT0RPOiBUZW1wb3JhcmlseSBkaXNhYmxlZCBkdWUgdG8gY29tcG9zaXRpbmcgaXNzdWVzXG4gICAgLy8gaWYgKHN0eWxlLmZpbmFsU2l6ZSkge1xuICAgIC8vICAgcHJvY2Vzc2VkID0gYXdhaXQgdGhpcy5hcHBseUZpbmFsU2l6ZShwcm9jZXNzZWQsIHN0eWxlLmZpbmFsU2l6ZSk7XG4gICAgLy8gfVxuXG4gICAgcmV0dXJuIHByb2Nlc3NlZC5wbmcoKS50b0J1ZmZlcigpO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgYXN5bmMgYXBwbHlCb3JkZXJSYWRpdXMoXG4gICAgaW1hZ2U6IHNoYXJwLlNoYXJwLFxuICAgIHJhZGl1czogbnVtYmVyLFxuICAgIHdpZHRoOiBudW1iZXIsXG4gICAgaGVpZ2h0OiBudW1iZXJcbiAgKTogUHJvbWlzZTxzaGFycC5TaGFycD4ge1xuICAgIC8vIEdldCBjdXJyZW50IGltYWdlIGRpbWVuc2lvbnMgaW4gY2FzZSB0aGV5J3ZlIGNoYW5nZWRcbiAgICBjb25zdCBtZXRhZGF0YSA9IGF3YWl0IGltYWdlLm1ldGFkYXRhKCk7XG4gICAgY29uc3QgY3VycmVudFdpZHRoID0gbWV0YWRhdGEud2lkdGggfHwgd2lkdGg7XG4gICAgY29uc3QgY3VycmVudEhlaWdodCA9IG1ldGFkYXRhLmhlaWdodCB8fCBoZWlnaHQ7XG5cbiAgICBjb25zdCBtYXNrID0gQnVmZmVyLmZyb20oXG4gICAgICBgPHN2ZyB3aWR0aD1cIiR7Y3VycmVudFdpZHRofVwiIGhlaWdodD1cIiR7Y3VycmVudEhlaWdodH1cIj5cbiAgICAgICAgPHJlY3QgeD1cIjBcIiB5PVwiMFwiIHdpZHRoPVwiJHtjdXJyZW50V2lkdGh9XCIgaGVpZ2h0PVwiJHtjdXJyZW50SGVpZ2h0fVwiIHJ4PVwiJHtyYWRpdXN9XCIgcnk9XCIke3JhZGl1c31cIiBmaWxsPVwid2hpdGVcIi8+XG4gICAgICA8L3N2Zz5gXG4gICAgKTtcblxuICAgIHJldHVybiBpbWFnZS5jb21wb3NpdGUoW1xuICAgICAge1xuICAgICAgICBpbnB1dDogbWFzayxcbiAgICAgICAgYmxlbmQ6ICdkZXN0LWluJ1xuICAgICAgfVxuICAgIF0pO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgYXN5bmMgYXBwbHlCYWNrZ3JvdW5kQW5kTWFyZ2luKFxuICAgIGltYWdlOiBzaGFycC5TaGFycCxcbiAgICBiYWNrZ3JvdW5kOiBCYWNrZ3JvdW5kU3R5bGUsXG4gICAgbWFyZ2luOiBudW1iZXIsXG4gICAgb3JpZ2luYWxXaWR0aDogbnVtYmVyLFxuICAgIG9yaWdpbmFsSGVpZ2h0OiBudW1iZXJcbiAgKTogUHJvbWlzZTxzaGFycC5TaGFycD4ge1xuICAgIC8vIEdldCBjdXJyZW50IGltYWdlIGRpbWVuc2lvbnMgaW4gY2FzZSB0aGV5J3ZlIGNoYW5nZWRcbiAgICBjb25zdCBtZXRhZGF0YSA9IGF3YWl0IGltYWdlLm1ldGFkYXRhKCk7XG4gICAgY29uc3QgY3VycmVudFdpZHRoID0gbWV0YWRhdGEud2lkdGggfHwgb3JpZ2luYWxXaWR0aDtcbiAgICBjb25zdCBjdXJyZW50SGVpZ2h0ID0gbWV0YWRhdGEuaGVpZ2h0IHx8IG9yaWdpbmFsSGVpZ2h0O1xuXG4gICAgY29uc3QgbmV3V2lkdGggPSBjdXJyZW50V2lkdGggKyAobWFyZ2luICogMik7XG4gICAgY29uc3QgbmV3SGVpZ2h0ID0gY3VycmVudEhlaWdodCArIChtYXJnaW4gKiAyKTtcblxuICAgIGxldCBiYWNrZ3JvdW5kQnVmZmVyOiBCdWZmZXI7XG5cbiAgICBpZiAoYmFja2dyb3VuZC50eXBlID09PSAnc29saWQnKSB7XG4gICAgICBiYWNrZ3JvdW5kQnVmZmVyID0gYXdhaXQgdGhpcy5jcmVhdGVTb2xpZEJhY2tncm91bmQobmV3V2lkdGgsIG5ld0hlaWdodCwgYmFja2dyb3VuZC5jb2xvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJhY2tncm91bmRCdWZmZXIgPSBhd2FpdCB0aGlzLmNyZWF0ZUdyYWRpZW50QmFja2dyb3VuZChuZXdXaWR0aCwgbmV3SGVpZ2h0LCBiYWNrZ3JvdW5kKTtcbiAgICB9XG5cbiAgICByZXR1cm4gc2hhcnAoYmFja2dyb3VuZEJ1ZmZlcikuY29tcG9zaXRlKFtcbiAgICAgIHtcbiAgICAgICAgaW5wdXQ6IGF3YWl0IGltYWdlLnRvQnVmZmVyKCksXG4gICAgICAgIGxlZnQ6IG1hcmdpbixcbiAgICAgICAgdG9wOiBtYXJnaW5cbiAgICAgIH1cbiAgICBdKTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGFzeW5jIGNyZWF0ZVNvbGlkQmFja2dyb3VuZCh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlciwgY29sb3I6IHN0cmluZyk6IFByb21pc2U8QnVmZmVyPiB7XG4gICAgcmV0dXJuIHNoYXJwKHtcbiAgICAgIGNyZWF0ZToge1xuICAgICAgICB3aWR0aCxcbiAgICAgICAgaGVpZ2h0LFxuICAgICAgICBjaGFubmVsczogNCxcbiAgICAgICAgYmFja2dyb3VuZDogY29sb3JcbiAgICAgIH1cbiAgICB9KS5wbmcoKS50b0J1ZmZlcigpO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgYXN5bmMgY3JlYXRlR3JhZGllbnRCYWNrZ3JvdW5kKFxuICAgIHdpZHRoOiBudW1iZXIsXG4gICAgaGVpZ2h0OiBudW1iZXIsXG4gICAgZ3JhZGllbnQ6IEV4dHJhY3Q8QmFja2dyb3VuZFN0eWxlLCB7IHR5cGU6ICdncmFkaWVudCcgfT5cbiAgKTogUHJvbWlzZTxCdWZmZXI+IHtcbiAgICBjb25zdCBhbmdsZSA9IHRoaXMuR1JBRElFTlRfQU5HTEVTW2dyYWRpZW50LmRpcmVjdGlvbl07XG4gICAgY29uc3Qgc3RvcHMgPSBncmFkaWVudC5jb2xvcnNcbiAgICAgIC5tYXAoKHsgY29sb3IsIHBvc2l0aW9uID0gNTAgfSkgPT4gYDxzdG9wIG9mZnNldD1cIiR7cG9zaXRpb259JVwiIHN0b3AtY29sb3I9XCIke2NvbG9yfVwiLz5gKVxuICAgICAgLmpvaW4oJycpO1xuXG4gICAgY29uc3Qgc3ZnID0gYFxuICAgICAgPHN2ZyB3aWR0aD1cIiR7d2lkdGh9XCIgaGVpZ2h0PVwiJHtoZWlnaHR9XCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPlxuICAgICAgICA8ZGVmcz5cbiAgICAgICAgICA8bGluZWFyR3JhZGllbnQgaWQ9XCJncmFkXCIgeDE9XCIwJVwiIHkxPVwiMCVcIiB4Mj1cIjEwMCVcIiB5Mj1cIjAlXCIgZ3JhZGllbnRUcmFuc2Zvcm09XCJyb3RhdGUoJHthbmdsZX0gMC41IDAuNSlcIj5cbiAgICAgICAgICAgICR7c3RvcHN9XG4gICAgICAgICAgPC9saW5lYXJHcmFkaWVudD5cbiAgICAgICAgPC9kZWZzPlxuICAgICAgICA8cmVjdCB3aWR0aD1cIjEwMCVcIiBoZWlnaHQ9XCIxMDAlXCIgZmlsbD1cInVybCgjZ3JhZClcIi8+XG4gICAgICA8L3N2Zz5cbiAgICBgO1xuXG4gICAgcmV0dXJuIEJ1ZmZlci5mcm9tKHN2Zyk7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBhc3luYyBhcHBseVNoYWRvdyhcbiAgICBpbWFnZTogc2hhcnAuU2hhcnAsXG4gICAgc2hhZG93OiBTdHlsZUNvbmZpZ1snc2hhZG93J11cbiAgKTogUHJvbWlzZTxzaGFycC5TaGFycD4ge1xuICAgIGNvbnN0IG1ldGFkYXRhID0gYXdhaXQgaW1hZ2UubWV0YWRhdGEoKTtcbiAgICBpZiAoIW1ldGFkYXRhLndpZHRoIHx8ICFtZXRhZGF0YS5oZWlnaHQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGFwcGx5IHNoYWRvdyB0byBpbWFnZSB3aXRob3V0IGRpbWVuc2lvbnMnKTtcbiAgICB9XG5cbiAgICBjb25zdCBzaGFkb3dXaWR0aCA9IG1ldGFkYXRhLndpZHRoICsgTWF0aC5hYnMoc2hhZG93Lm9mZnNldFgpICsgKHNoYWRvdy5ibHVyICogMik7XG4gICAgY29uc3Qgc2hhZG93SGVpZ2h0ID0gbWV0YWRhdGEuaGVpZ2h0ICsgTWF0aC5hYnMoc2hhZG93Lm9mZnNldFkpICsgKHNoYWRvdy5ibHVyICogMik7XG5cbiAgICBjb25zdCBzaGFkb3dTdmcgPSBgXG4gICAgICA8c3ZnIHdpZHRoPVwiJHtzaGFkb3dXaWR0aH1cIiBoZWlnaHQ9XCIke3NoYWRvd0hlaWdodH1cIj5cbiAgICAgICAgPGRlZnM+XG4gICAgICAgICAgPGZpbHRlciBpZD1cInNoYWRvd1wiIHg9XCItNTAlXCIgeT1cIi01MCVcIiB3aWR0aD1cIjIwMCVcIiBoZWlnaHQ9XCIyMDAlXCI+XG4gICAgICAgICAgICA8ZmVHYXVzc2lhbkJsdXIgaW49XCJTb3VyY2VHcmFwaGljXCIgc3RkRGV2aWF0aW9uPVwiJHtzaGFkb3cuYmx1cn1cIi8+XG4gICAgICAgICAgICA8ZmVPZmZzZXQgZHg9XCIke3NoYWRvdy5vZmZzZXRYfVwiIGR5PVwiJHtzaGFkb3cub2Zmc2V0WX1cIiByZXN1bHQ9XCJvZmZzZXRcIi8+XG4gICAgICAgICAgICA8ZmVGbG9vZCBmbG9vZC1jb2xvcj1cIiR7c2hhZG93LmNvbG9yfVwiIGZsb29kLW9wYWNpdHk9XCIke3NoYWRvdy5vcGFjaXR5fVwiLz5cbiAgICAgICAgICAgIDxmZUNvbXBvc2l0ZSBpbj1cIlNvdXJjZUdyYXBoaWNcIiBvcGVyYXRvcj1cIm92ZXJcIi8+XG4gICAgICAgICAgPC9maWx0ZXI+XG4gICAgICAgIDwvZGVmcz5cbiAgICAgICAgPHJlY3Qgd2lkdGg9XCIxMDAlXCIgaGVpZ2h0PVwiMTAwJVwiIGZpbGw9XCJ0cmFuc3BhcmVudFwiLz5cbiAgICAgIDwvc3ZnPlxuICAgIGA7XG5cbiAgICBjb25zdCBzaGFkb3dCdWZmZXIgPSBCdWZmZXIuZnJvbShzaGFkb3dTdmcpO1xuICAgIGNvbnN0IGJhc2VYID0gTWF0aC5tYXgoMCwgLXNoYWRvdy5vZmZzZXRYKSArIHNoYWRvdy5ibHVyO1xuICAgIGNvbnN0IGJhc2VZID0gTWF0aC5tYXgoMCwgLXNoYWRvdy5vZmZzZXRZKSArIHNoYWRvdy5ibHVyO1xuXG4gICAgcmV0dXJuIHNoYXJwKHtcbiAgICAgIGNyZWF0ZToge1xuICAgICAgICB3aWR0aDogc2hhZG93V2lkdGgsXG4gICAgICAgIGhlaWdodDogc2hhZG93SGVpZ2h0LFxuICAgICAgICBjaGFubmVsczogNCxcbiAgICAgICAgYmFja2dyb3VuZDogeyByOiAwLCBnOiAwLCBiOiAwLCBhbHBoYTogMCB9XG4gICAgICB9XG4gICAgfSkuY29tcG9zaXRlKFtcbiAgICAgIHtcbiAgICAgICAgaW5wdXQ6IHNoYWRvd0J1ZmZlcixcbiAgICAgICAgYmxlbmQ6ICdtdWx0aXBseSdcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGlucHV0OiBhd2FpdCBpbWFnZS50b0J1ZmZlcigpLFxuICAgICAgICBsZWZ0OiBiYXNlWCxcbiAgICAgICAgdG9wOiBiYXNlWVxuICAgICAgfVxuICAgIF0pO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgYXN5bmMgYXBwbHlGaW5hbFNpemUoXG4gICAgaW1hZ2U6IHNoYXJwLlNoYXJwLFxuICAgIGZpbmFsU2l6ZTogRmluYWxJbWFnZVNpemVcbiAgKTogUHJvbWlzZTxzaGFycC5TaGFycD4ge1xuICAgIGNvbnN0IG1ldGFkYXRhID0gYXdhaXQgaW1hZ2UubWV0YWRhdGEoKTtcbiAgICBpZiAoIW1ldGFkYXRhLndpZHRoIHx8ICFtZXRhZGF0YS5oZWlnaHQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGFwcGx5IGZpbmFsIHNpemUgdG8gaW1hZ2Ugd2l0aG91dCBkaW1lbnNpb25zJyk7XG4gICAgfVxuXG4gICAgbGV0IHRhcmdldFdpZHRoOiBudW1iZXIgfCB1bmRlZmluZWQgPSBmaW5hbFNpemUud2lkdGg7XG4gICAgbGV0IHRhcmdldEhlaWdodDogbnVtYmVyIHwgdW5kZWZpbmVkID0gZmluYWxTaXplLmhlaWdodDtcblxuICAgIGlmIChmaW5hbFNpemUuYXNwZWN0UmF0aW8pIHtcbiAgICAgIGNvbnN0IFtyYXRpb1csIHJhdGlvSF0gPSBmaW5hbFNpemUuYXNwZWN0UmF0aW8uc3BsaXQoJzonKS5tYXAoTnVtYmVyKTtcbiAgICAgIGNvbnN0IHJhdGlvID0gcmF0aW9XIC8gcmF0aW9IO1xuXG4gICAgICBpZiAoZmluYWxTaXplLndpZHRoICYmICFmaW5hbFNpemUuaGVpZ2h0KSB7XG4gICAgICAgIHRhcmdldEhlaWdodCA9IE1hdGgucm91bmQoZmluYWxTaXplLndpZHRoIC8gcmF0aW8pO1xuICAgICAgfSBlbHNlIGlmIChmaW5hbFNpemUuaGVpZ2h0ICYmICFmaW5hbFNpemUud2lkdGgpIHtcbiAgICAgICAgdGFyZ2V0V2lkdGggPSBNYXRoLnJvdW5kKGZpbmFsU2l6ZS5oZWlnaHQgKiByYXRpbyk7XG4gICAgICB9IGVsc2UgaWYgKCFmaW5hbFNpemUud2lkdGggJiYgIWZpbmFsU2l6ZS5oZWlnaHQpIHtcbiAgICAgICAgY29uc3QgY3VycmVudFJhdGlvID0gbWV0YWRhdGEud2lkdGggLyBtZXRhZGF0YS5oZWlnaHQ7XG4gICAgICAgIGlmIChyYXRpbyA+IGN1cnJlbnRSYXRpbykge1xuICAgICAgICAgIHRhcmdldFdpZHRoID0gbWV0YWRhdGEud2lkdGg7XG4gICAgICAgICAgdGFyZ2V0SGVpZ2h0ID0gTWF0aC5yb3VuZChtZXRhZGF0YS53aWR0aCAvIHJhdGlvKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0YXJnZXRIZWlnaHQgPSBtZXRhZGF0YS5oZWlnaHQ7XG4gICAgICAgICAgdGFyZ2V0V2lkdGggPSBNYXRoLnJvdW5kKG1ldGFkYXRhLmhlaWdodCAqIHJhdGlvKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghdGFyZ2V0V2lkdGggJiYgIXRhcmdldEhlaWdodCkge1xuICAgICAgcmV0dXJuIGltYWdlO1xuICAgIH1cblxuICAgIGxldCByZXNpemVPcHRpb25zOiBzaGFycC5SZXNpemVPcHRpb25zID0ge1xuICAgICAgZml0OiBmaW5hbFNpemUubWFpbnRhaW5Bc3BlY3RSYXRpbyAhPT0gZmFsc2UgPyAnaW5zaWRlJyA6ICdmaWxsJyxcbiAgICAgIHdpdGhvdXRFbmxhcmdlbWVudDogZmFsc2VcbiAgICB9O1xuXG4gICAgaWYgKHRhcmdldFdpZHRoICYmIHRhcmdldEhlaWdodCkge1xuICAgICAgcmV0dXJuIGltYWdlLnJlc2l6ZSh0YXJnZXRXaWR0aCwgdGFyZ2V0SGVpZ2h0LCByZXNpemVPcHRpb25zKTtcbiAgICB9IGVsc2UgaWYgKHRhcmdldFdpZHRoKSB7XG4gICAgICByZXR1cm4gaW1hZ2UucmVzaXplKHRhcmdldFdpZHRoLCB1bmRlZmluZWQsIHJlc2l6ZU9wdGlvbnMpO1xuICAgIH0gZWxzZSBpZiAodGFyZ2V0SGVpZ2h0KSB7XG4gICAgICByZXR1cm4gaW1hZ2UucmVzaXplKHVuZGVmaW5lZCwgdGFyZ2V0SGVpZ2h0LCByZXNpemVPcHRpb25zKTtcbiAgICB9XG5cbiAgICByZXR1cm4gaW1hZ2U7XG4gIH1cblxuICBzdGF0aWMgZ2V0RGVmYXVsdFN0eWxlKCk6IFN0eWxlQ29uZmlnIHtcbiAgICByZXR1cm4ge1xuICAgICAgYm9yZGVyUmFkaXVzOiA4LFxuICAgICAgbWFyZ2luOiAzMixcbiAgICAgIGJhY2tncm91bmQ6IHtcbiAgICAgICAgdHlwZTogJ2dyYWRpZW50JyxcbiAgICAgICAgZGlyZWN0aW9uOiAndG8tYnInLFxuICAgICAgICBjb2xvcnM6IFtcbiAgICAgICAgICB7IGNvbG9yOiAnIzY2N2VlYScsIHBvc2l0aW9uOiAwIH0sXG4gICAgICAgICAgeyBjb2xvcjogJyM3NjRiYTInLCBwb3NpdGlvbjogMTAwIH1cbiAgICAgICAgXVxuICAgICAgfSxcbiAgICAgIGJyb3dzZXJNb2NrdXA6ICdub25lJyxcbiAgICAgIHNoYWRvdzoge1xuICAgICAgICBlbmFibGVkOiB0cnVlLFxuICAgICAgICBibHVyOiAyMCxcbiAgICAgICAgb2Zmc2V0WDogMCxcbiAgICAgICAgb2Zmc2V0WTogMTAsXG4gICAgICAgIGNvbG9yOiAnIzAwMDAwMCcsXG4gICAgICAgIG9wYWNpdHk6IDAuMTVcbiAgICAgIH1cbiAgICB9O1xuICB9XG59Il0sIm5hbWVzIjpbInNoYXJwIiwiSW1hZ2VQcm9jZXNzb3IiLCJHUkFESUVOVF9BTkdMRVMiLCJwcm9jZXNzU2NyZWVuc2hvdCIsImltYWdlQnVmZmVyIiwic3R5bGUiLCJpbWFnZSIsIm1ldGFkYXRhIiwid2lkdGgiLCJoZWlnaHQiLCJFcnJvciIsInByb2Nlc3NlZCIsImJvcmRlclJhZGl1cyIsImFwcGx5Qm9yZGVyUmFkaXVzIiwibWFyZ2luIiwiYmFja2dyb3VuZCIsInR5cGUiLCJjb2xvciIsImFwcGx5QmFja2dyb3VuZEFuZE1hcmdpbiIsInNoYWRvdyIsImVuYWJsZWQiLCJhcHBseVNoYWRvdyIsInBuZyIsInRvQnVmZmVyIiwicmFkaXVzIiwiY3VycmVudFdpZHRoIiwiY3VycmVudEhlaWdodCIsIm1hc2siLCJCdWZmZXIiLCJmcm9tIiwiY29tcG9zaXRlIiwiaW5wdXQiLCJibGVuZCIsIm9yaWdpbmFsV2lkdGgiLCJvcmlnaW5hbEhlaWdodCIsIm5ld1dpZHRoIiwibmV3SGVpZ2h0IiwiYmFja2dyb3VuZEJ1ZmZlciIsImNyZWF0ZVNvbGlkQmFja2dyb3VuZCIsImNyZWF0ZUdyYWRpZW50QmFja2dyb3VuZCIsImxlZnQiLCJ0b3AiLCJjcmVhdGUiLCJjaGFubmVscyIsImdyYWRpZW50IiwiYW5nbGUiLCJkaXJlY3Rpb24iLCJzdG9wcyIsImNvbG9ycyIsIm1hcCIsInBvc2l0aW9uIiwiam9pbiIsInN2ZyIsInNoYWRvd1dpZHRoIiwiTWF0aCIsImFicyIsIm9mZnNldFgiLCJibHVyIiwic2hhZG93SGVpZ2h0Iiwib2Zmc2V0WSIsInNoYWRvd1N2ZyIsIm9wYWNpdHkiLCJzaGFkb3dCdWZmZXIiLCJiYXNlWCIsIm1heCIsImJhc2VZIiwiciIsImciLCJiIiwiYWxwaGEiLCJhcHBseUZpbmFsU2l6ZSIsImZpbmFsU2l6ZSIsInRhcmdldFdpZHRoIiwidGFyZ2V0SGVpZ2h0IiwiYXNwZWN0UmF0aW8iLCJyYXRpb1ciLCJyYXRpb0giLCJzcGxpdCIsIk51bWJlciIsInJhdGlvIiwicm91bmQiLCJjdXJyZW50UmF0aW8iLCJyZXNpemVPcHRpb25zIiwiZml0IiwibWFpbnRhaW5Bc3BlY3RSYXRpbyIsIndpdGhvdXRFbmxhcmdlbWVudCIsInJlc2l6ZSIsInVuZGVmaW5lZCIsImdldERlZmF1bHRTdHlsZSIsImJyb3dzZXJNb2NrdXAiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/image-processor.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/microlink.ts":
/*!***************************************!*\
  !*** ./src/lib/services/microlink.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MicrolinkService: () => (/* binding */ MicrolinkService)\n/* harmony export */ });\nconst MICROLINK_API_BASE = \"https://api.microlink.io\";\nclass MicrolinkService {\n    static optimizeViewportForFinalSize(config, finalSize) {\n        if (!finalSize) return config;\n        const optimizedConfig = {\n            ...config\n        };\n        let { width, height } = config.viewport;\n        // Parse aspect ratio if provided\n        if (finalSize.aspectRatio) {\n            const [ratioW, ratioH] = finalSize.aspectRatio.split(\":\").map(Number);\n            const ratio = ratioW / ratioH;\n            if (finalSize.width && !finalSize.height) {\n                // Width specified, calculate height from aspect ratio\n                height = Math.round(finalSize.width / ratio);\n                width = finalSize.width;\n            } else if (finalSize.height && !finalSize.width) {\n                // Height specified, calculate width from aspect ratio\n                width = Math.round(finalSize.height * ratio);\n                height = finalSize.height;\n            } else if (finalSize.width && finalSize.height) {\n                // Both specified, use them directly\n                width = finalSize.width;\n                height = finalSize.height;\n            } else {\n                // Only aspect ratio specified, use default size with correct ratio\n                if (ratio > 1) {\n                    // Landscape\n                    width = 1920;\n                    height = Math.round(1920 / ratio);\n                } else {\n                    // Portrait or square\n                    height = 1080;\n                    width = Math.round(1080 * ratio);\n                }\n            }\n        } else {\n            // No aspect ratio, use specified dimensions or defaults\n            if (finalSize.width) width = finalSize.width;\n            if (finalSize.height) height = finalSize.height;\n        }\n        // Ensure minimum sizes for Microlink\n        width = Math.max(320, width);\n        height = Math.max(240, height);\n        optimizedConfig.viewport = {\n            ...config.viewport,\n            width,\n            height\n        };\n        return optimizedConfig;\n    }\n    static getScreenshotUrl(config) {\n        const params = new URLSearchParams({\n            url: config.url,\n            screenshot: \"true\",\n            waitUntil: config.waitUntil,\n            meta: \"false\",\n            embed: \"screenshot.url\",\n            colorScheme: config.colorScheme,\n            \"viewport.isMobile\": config.viewport.isMobile.toString(),\n            \"viewport.deviceScaleFactor\": config.viewport.deviceScaleFactor.toString(),\n            \"viewport.width\": config.viewport.width.toString(),\n            \"viewport.height\": config.viewport.height.toString(),\n            delay: config.delay.toString()\n        });\n        return `${MICROLINK_API_BASE}?${params.toString()}`;\n    }\n    static async fetchScreenshot(config) {\n        const apiUrl = this.getScreenshotUrl(config);\n        try {\n            console.log(`Fetching screenshot from: ${apiUrl}`);\n            const response = await fetch(apiUrl, {\n                headers: {\n                    \"User-Agent\": \"Snap-API/1.0.0\"\n                }\n            });\n            if (!response.ok) {\n                const errorText = await response.text().catch(()=>\"Unknown error\");\n                throw new Error(`Microlink API error: ${response.status} ${response.statusText} - ${errorText}`);\n            }\n            const contentType = response.headers.get(\"content-type\");\n            console.log(`Response content-type: ${contentType}`);\n            // Handle direct image response (when embed=screenshot.url returns the image directly)\n            if (contentType && contentType.startsWith(\"image/\")) {\n                console.log(\"Received direct image response from Microlink\");\n                const imageBuffer = await response.arrayBuffer();\n                if (imageBuffer.byteLength === 0) {\n                    throw new Error(\"Received empty image buffer\");\n                }\n                return Buffer.from(imageBuffer);\n            }\n            // Handle JSON response (traditional API response with screenshot URL)\n            if (!contentType || !contentType.includes(\"application/json\")) {\n                throw new Error(`Unexpected content-type: ${contentType}. Expected JSON or image.`);\n            }\n            let data;\n            try {\n                data = await response.json();\n            } catch (parseError) {\n                const responseText = await response.text().catch(()=>\"Unable to read response\");\n                throw new Error(`Failed to parse JSON response: ${responseText.slice(0, 200)}...`);\n            }\n            if (data.status !== \"success\") {\n                throw new Error(`Microlink API returned error status: ${data.status}`);\n            }\n            if (!data.data?.screenshot?.url) {\n                throw new Error(`Screenshot URL not found in response: ${JSON.stringify(data).slice(0, 200)}`);\n            }\n            console.log(`Downloading image from: ${data.data.screenshot.url}`);\n            const imageResponse = await fetch(data.data.screenshot.url);\n            if (!imageResponse.ok) {\n                throw new Error(`Failed to fetch screenshot image: ${imageResponse.status} ${imageResponse.statusText}`);\n            }\n            const imageBuffer = await imageResponse.arrayBuffer();\n            if (imageBuffer.byteLength === 0) {\n                throw new Error(\"Received empty image buffer\");\n            }\n            return Buffer.from(imageBuffer);\n        } catch (error) {\n            if (error instanceof Error) {\n                // Re-throw with more context\n                throw new Error(`Screenshot fetch failed: ${error.message}`);\n            }\n            throw new Error(\"Screenshot fetch failed: Unknown error\");\n        }\n    }\n    static getDefaultConfig() {\n        return {\n            url: \"\",\n            waitUntil: \"networkidle0\",\n            delay: 2000,\n            colorScheme: \"dark\",\n            viewport: {\n                width: 1920,\n                height: 1080,\n                isMobile: false,\n                deviceScaleFactor: 1\n            }\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QSxNQUFNLElBQUlyQixNQUFNO1FBQ2xCO0lBQ0Y7SUFFQSxPQUFPc0IsbUJBQXFDO1FBQzFDLE9BQU87WUFDTDNDLEtBQUs7WUFDTEUsV0FBVztZQUNYTyxPQUFPO1lBQ1BKLGFBQWE7WUFDYm5CLFVBQVU7Z0JBQ1JGLE9BQU87Z0JBQ1BDLFFBQVE7Z0JBQ1JxQixVQUFVO2dCQUNWRSxtQkFBbUI7WUFDckI7UUFDRjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbmFwLy4vc3JjL2xpYi9zZXJ2aWNlcy9taWNyb2xpbmsudHM/NzQ4NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IFNjcmVlbnNob3RDb25maWcsIE1pY3JvbGlua1Jlc3BvbnNlLCBGaW5hbEltYWdlU2l6ZSB9IGZyb20gJy4uL3R5cGVzLmpzJztcblxuY29uc3QgTUlDUk9MSU5LX0FQSV9CQVNFID0gJ2h0dHBzOi8vYXBpLm1pY3JvbGluay5pbyc7XG5cbmV4cG9ydCBjbGFzcyBNaWNyb2xpbmtTZXJ2aWNlIHtcbiAgc3RhdGljIG9wdGltaXplVmlld3BvcnRGb3JGaW5hbFNpemUoY29uZmlnOiBTY3JlZW5zaG90Q29uZmlnLCBmaW5hbFNpemU/OiBGaW5hbEltYWdlU2l6ZSk6IFNjcmVlbnNob3RDb25maWcge1xuICAgIGlmICghZmluYWxTaXplKSByZXR1cm4gY29uZmlnO1xuXG4gICAgY29uc3Qgb3B0aW1pemVkQ29uZmlnID0geyAuLi5jb25maWcgfTtcbiAgICBsZXQgeyB3aWR0aCwgaGVpZ2h0IH0gPSBjb25maWcudmlld3BvcnQ7XG5cbiAgICAvLyBQYXJzZSBhc3BlY3QgcmF0aW8gaWYgcHJvdmlkZWRcbiAgICBpZiAoZmluYWxTaXplLmFzcGVjdFJhdGlvKSB7XG4gICAgICBjb25zdCBbcmF0aW9XLCByYXRpb0hdID0gZmluYWxTaXplLmFzcGVjdFJhdGlvLnNwbGl0KCc6JykubWFwKE51bWJlcik7XG4gICAgICBjb25zdCByYXRpbyA9IHJhdGlvVyAvIHJhdGlvSDtcbiAgICAgIFxuICAgICAgaWYgKGZpbmFsU2l6ZS53aWR0aCAmJiAhZmluYWxTaXplLmhlaWdodCkge1xuICAgICAgICAvLyBXaWR0aCBzcGVjaWZpZWQsIGNhbGN1bGF0ZSBoZWlnaHQgZnJvbSBhc3BlY3QgcmF0aW9cbiAgICAgICAgaGVpZ2h0ID0gTWF0aC5yb3VuZChmaW5hbFNpemUud2lkdGggLyByYXRpbyk7XG4gICAgICAgIHdpZHRoID0gZmluYWxTaXplLndpZHRoO1xuICAgICAgfSBlbHNlIGlmIChmaW5hbFNpemUuaGVpZ2h0ICYmICFmaW5hbFNpemUud2lkdGgpIHtcbiAgICAgICAgLy8gSGVpZ2h0IHNwZWNpZmllZCwgY2FsY3VsYXRlIHdpZHRoIGZyb20gYXNwZWN0IHJhdGlvXG4gICAgICAgIHdpZHRoID0gTWF0aC5yb3VuZChmaW5hbFNpemUuaGVpZ2h0ICogcmF0aW8pO1xuICAgICAgICBoZWlnaHQgPSBmaW5hbFNpemUuaGVpZ2h0O1xuICAgICAgfSBlbHNlIGlmIChmaW5hbFNpemUud2lkdGggJiYgZmluYWxTaXplLmhlaWdodCkge1xuICAgICAgICAvLyBCb3RoIHNwZWNpZmllZCwgdXNlIHRoZW0gZGlyZWN0bHlcbiAgICAgICAgd2lkdGggPSBmaW5hbFNpemUud2lkdGg7XG4gICAgICAgIGhlaWdodCA9IGZpbmFsU2l6ZS5oZWlnaHQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBPbmx5IGFzcGVjdCByYXRpbyBzcGVjaWZpZWQsIHVzZSBkZWZhdWx0IHNpemUgd2l0aCBjb3JyZWN0IHJhdGlvXG4gICAgICAgIGlmIChyYXRpbyA+IDEpIHtcbiAgICAgICAgICAvLyBMYW5kc2NhcGVcbiAgICAgICAgICB3aWR0aCA9IDE5MjA7XG4gICAgICAgICAgaGVpZ2h0ID0gTWF0aC5yb3VuZCgxOTIwIC8gcmF0aW8pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIFBvcnRyYWl0IG9yIHNxdWFyZVxuICAgICAgICAgIGhlaWdodCA9IDEwODA7XG4gICAgICAgICAgd2lkdGggPSBNYXRoLnJvdW5kKDEwODAgKiByYXRpbyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gTm8gYXNwZWN0IHJhdGlvLCB1c2Ugc3BlY2lmaWVkIGRpbWVuc2lvbnMgb3IgZGVmYXVsdHNcbiAgICAgIGlmIChmaW5hbFNpemUud2lkdGgpIHdpZHRoID0gZmluYWxTaXplLndpZHRoO1xuICAgICAgaWYgKGZpbmFsU2l6ZS5oZWlnaHQpIGhlaWdodCA9IGZpbmFsU2l6ZS5oZWlnaHQ7XG4gICAgfVxuXG4gICAgLy8gRW5zdXJlIG1pbmltdW0gc2l6ZXMgZm9yIE1pY3JvbGlua1xuICAgIHdpZHRoID0gTWF0aC5tYXgoMzIwLCB3aWR0aCk7XG4gICAgaGVpZ2h0ID0gTWF0aC5tYXgoMjQwLCBoZWlnaHQpO1xuXG4gICAgb3B0aW1pemVkQ29uZmlnLnZpZXdwb3J0ID0ge1xuICAgICAgLi4uY29uZmlnLnZpZXdwb3J0LFxuICAgICAgd2lkdGgsXG4gICAgICBoZWlnaHRcbiAgICB9O1xuXG4gICAgcmV0dXJuIG9wdGltaXplZENvbmZpZztcbiAgfVxuXG4gIHN0YXRpYyBnZXRTY3JlZW5zaG90VXJsKGNvbmZpZzogU2NyZWVuc2hvdENvbmZpZyk6IHN0cmluZyB7XG4gICAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICB1cmw6IGNvbmZpZy51cmwsXG4gICAgICBzY3JlZW5zaG90OiAndHJ1ZScsXG4gICAgICB3YWl0VW50aWw6IGNvbmZpZy53YWl0VW50aWwsXG4gICAgICBtZXRhOiAnZmFsc2UnLFxuICAgICAgZW1iZWQ6ICdzY3JlZW5zaG90LnVybCcsXG4gICAgICBjb2xvclNjaGVtZTogY29uZmlnLmNvbG9yU2NoZW1lLFxuICAgICAgJ3ZpZXdwb3J0LmlzTW9iaWxlJzogY29uZmlnLnZpZXdwb3J0LmlzTW9iaWxlLnRvU3RyaW5nKCksXG4gICAgICAndmlld3BvcnQuZGV2aWNlU2NhbGVGYWN0b3InOiBjb25maWcudmlld3BvcnQuZGV2aWNlU2NhbGVGYWN0b3IudG9TdHJpbmcoKSxcbiAgICAgICd2aWV3cG9ydC53aWR0aCc6IGNvbmZpZy52aWV3cG9ydC53aWR0aC50b1N0cmluZygpLFxuICAgICAgJ3ZpZXdwb3J0LmhlaWdodCc6IGNvbmZpZy52aWV3cG9ydC5oZWlnaHQudG9TdHJpbmcoKSxcbiAgICAgIGRlbGF5OiBjb25maWcuZGVsYXkudG9TdHJpbmcoKSxcbiAgICB9KTtcblxuICAgIHJldHVybiBgJHtNSUNST0xJTktfQVBJX0JBU0V9PyR7cGFyYW1zLnRvU3RyaW5nKCl9YDtcbiAgfVxuXG4gIHN0YXRpYyBhc3luYyBmZXRjaFNjcmVlbnNob3QoY29uZmlnOiBTY3JlZW5zaG90Q29uZmlnKTogUHJvbWlzZTxCdWZmZXI+IHtcbiAgICBjb25zdCBhcGlVcmwgPSB0aGlzLmdldFNjcmVlbnNob3RVcmwoY29uZmlnKTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coYEZldGNoaW5nIHNjcmVlbnNob3QgZnJvbTogJHthcGlVcmx9YCk7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGFwaVVybCwge1xuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgJ1VzZXItQWdlbnQnOiAnU25hcC1BUEkvMS4wLjAnXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKS5jYXRjaCgoKSA9PiAnVW5rbm93biBlcnJvcicpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1pY3JvbGluayBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9IC0gJHtlcnJvclRleHR9YCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gcmVzcG9uc2UuaGVhZGVycy5nZXQoJ2NvbnRlbnQtdHlwZScpO1xuICAgICAgY29uc29sZS5sb2coYFJlc3BvbnNlIGNvbnRlbnQtdHlwZTogJHtjb250ZW50VHlwZX1gKTtcblxuICAgICAgLy8gSGFuZGxlIGRpcmVjdCBpbWFnZSByZXNwb25zZSAod2hlbiBlbWJlZD1zY3JlZW5zaG90LnVybCByZXR1cm5zIHRoZSBpbWFnZSBkaXJlY3RseSlcbiAgICAgIGlmIChjb250ZW50VHlwZSAmJiBjb250ZW50VHlwZS5zdGFydHNXaXRoKCdpbWFnZS8nKSkge1xuICAgICAgICBjb25zb2xlLmxvZygnUmVjZWl2ZWQgZGlyZWN0IGltYWdlIHJlc3BvbnNlIGZyb20gTWljcm9saW5rJyk7XG4gICAgICAgIGNvbnN0IGltYWdlQnVmZmVyID0gYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChpbWFnZUJ1ZmZlci5ieXRlTGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZWNlaXZlZCBlbXB0eSBpbWFnZSBidWZmZXInKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBCdWZmZXIuZnJvbShpbWFnZUJ1ZmZlcik7XG4gICAgICB9XG5cbiAgICAgIC8vIEhhbmRsZSBKU09OIHJlc3BvbnNlICh0cmFkaXRpb25hbCBBUEkgcmVzcG9uc2Ugd2l0aCBzY3JlZW5zaG90IFVSTClcbiAgICAgIGlmICghY29udGVudFR5cGUgfHwgIWNvbnRlbnRUeXBlLmluY2x1ZGVzKCdhcHBsaWNhdGlvbi9qc29uJykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmV4cGVjdGVkIGNvbnRlbnQtdHlwZTogJHtjb250ZW50VHlwZX0uIEV4cGVjdGVkIEpTT04gb3IgaW1hZ2UuYCk7XG4gICAgICB9XG5cbiAgICAgIGxldCBkYXRhOiBNaWNyb2xpbmtSZXNwb25zZTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICB9IGNhdGNoIChwYXJzZUVycm9yKSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKS5jYXRjaCgoKSA9PiAnVW5hYmxlIHRvIHJlYWQgcmVzcG9uc2UnKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gcGFyc2UgSlNPTiByZXNwb25zZTogJHtyZXNwb25zZVRleHQuc2xpY2UoMCwgMjAwKX0uLi5gKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGRhdGEuc3RhdHVzICE9PSAnc3VjY2VzcycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBNaWNyb2xpbmsgQVBJIHJldHVybmVkIGVycm9yIHN0YXR1czogJHtkYXRhLnN0YXR1c31gKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKCFkYXRhLmRhdGE/LnNjcmVlbnNob3Q/LnVybCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFNjcmVlbnNob3QgVVJMIG5vdCBmb3VuZCBpbiByZXNwb25zZTogJHtKU09OLnN0cmluZ2lmeShkYXRhKS5zbGljZSgwLCAyMDApfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zb2xlLmxvZyhgRG93bmxvYWRpbmcgaW1hZ2UgZnJvbTogJHtkYXRhLmRhdGEuc2NyZWVuc2hvdC51cmx9YCk7XG4gICAgICBjb25zdCBpbWFnZVJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZGF0YS5kYXRhLnNjcmVlbnNob3QudXJsKTtcbiAgICAgIFxuICAgICAgaWYgKCFpbWFnZVJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGZldGNoIHNjcmVlbnNob3QgaW1hZ2U6ICR7aW1hZ2VSZXNwb25zZS5zdGF0dXN9ICR7aW1hZ2VSZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBpbWFnZUJ1ZmZlciA9IGF3YWl0IGltYWdlUmVzcG9uc2UuYXJyYXlCdWZmZXIoKTtcbiAgICAgIGlmIChpbWFnZUJ1ZmZlci5ieXRlTGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUmVjZWl2ZWQgZW1wdHkgaW1hZ2UgYnVmZmVyJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBCdWZmZXIuZnJvbShpbWFnZUJ1ZmZlcik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgIC8vIFJlLXRocm93IHdpdGggbW9yZSBjb250ZXh0XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgU2NyZWVuc2hvdCBmZXRjaCBmYWlsZWQ6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBFcnJvcignU2NyZWVuc2hvdCBmZXRjaCBmYWlsZWQ6IFVua25vd24gZXJyb3InKTtcbiAgICB9XG4gIH1cblxuICBzdGF0aWMgZ2V0RGVmYXVsdENvbmZpZygpOiBTY3JlZW5zaG90Q29uZmlnIHtcbiAgICByZXR1cm4ge1xuICAgICAgdXJsOiAnJyxcbiAgICAgIHdhaXRVbnRpbDogJ25ldHdvcmtpZGxlMCcsXG4gICAgICBkZWxheTogMjAwMCxcbiAgICAgIGNvbG9yU2NoZW1lOiAnZGFyaycsXG4gICAgICB2aWV3cG9ydDoge1xuICAgICAgICB3aWR0aDogMTkyMCxcbiAgICAgICAgaGVpZ2h0OiAxMDgwLFxuICAgICAgICBpc01vYmlsZTogZmFsc2UsXG4gICAgICAgIGRldmljZVNjYWxlRmFjdG9yOiAxLFxuICAgICAgfVxuICAgIH07XG4gIH1cbn0iXSwibmFtZXMiOlsiTUlDUk9MSU5LX0FQSV9CQVNFIiwiTWljcm9saW5rU2VydmljZSIsIm9wdGltaXplVmlld3BvcnRGb3JGaW5hbFNpemUiLCJjb25maWciLCJmaW5hbFNpemUiLCJvcHRpbWl6ZWRDb25maWciLCJ3aWR0aCIsImhlaWdodCIsInZpZXdwb3J0IiwiYXNwZWN0UmF0aW8iLCJyYXRpb1ciLCJyYXRpb0giLCJzcGxpdCIsIm1hcCIsIk51bWJlciIsInJhdGlvIiwiTWF0aCIsInJvdW5kIiwibWF4IiwiZ2V0U2NyZWVuc2hvdFVybCIsInBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsInVybCIsInNjcmVlbnNob3QiLCJ3YWl0VW50aWwiLCJtZXRhIiwiZW1iZWQiLCJjb2xvclNjaGVtZSIsImlzTW9iaWxlIiwidG9TdHJpbmciLCJkZXZpY2VTY2FsZUZhY3RvciIsImRlbGF5IiwiZmV0Y2hTY3JlZW5zaG90IiwiYXBpVXJsIiwiY29uc29sZSIsImxvZyIsInJlc3BvbnNlIiwiZmV0Y2giLCJoZWFkZXJzIiwib2siLCJlcnJvclRleHQiLCJ0ZXh0IiwiY2F0Y2giLCJFcnJvciIsInN0YXR1cyIsInN0YXR1c1RleHQiLCJjb250ZW50VHlwZSIsImdldCIsInN0YXJ0c1dpdGgiLCJpbWFnZUJ1ZmZlciIsImFycmF5QnVmZmVyIiwiYnl0ZUxlbmd0aCIsIkJ1ZmZlciIsImZyb20iLCJpbmNsdWRlcyIsImRhdGEiLCJqc29uIiwicGFyc2VFcnJvciIsInJlc3BvbnNlVGV4dCIsInNsaWNlIiwiSlNPTiIsInN0cmluZ2lmeSIsImltYWdlUmVzcG9uc2UiLCJlcnJvciIsIm1lc3NhZ2UiLCJnZXREZWZhdWx0Q29uZmlnIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/microlink.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/validation.ts":
/*!*******************************!*\
  !*** ./src/lib/validation.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   backgroundStyleSchema: () => (/* binding */ backgroundStyleSchema),\n/* harmony export */   browserMockupSchema: () => (/* binding */ browserMockupSchema),\n/* harmony export */   colorSchemeSchema: () => (/* binding */ colorSchemeSchema),\n/* harmony export */   finalImageSizeSchema: () => (/* binding */ finalImageSizeSchema),\n/* harmony export */   gradientBackgroundSchema: () => (/* binding */ gradientBackgroundSchema),\n/* harmony export */   gradientColorSchema: () => (/* binding */ gradientColorSchema),\n/* harmony export */   gradientDirectionSchema: () => (/* binding */ gradientDirectionSchema),\n/* harmony export */   queryToRequest: () => (/* binding */ queryToRequest),\n/* harmony export */   screenshotConfigSchema: () => (/* binding */ screenshotConfigSchema),\n/* harmony export */   shadowConfigSchema: () => (/* binding */ shadowConfigSchema),\n/* harmony export */   snapQuerySchema: () => (/* binding */ snapQuerySchema),\n/* harmony export */   snapRequestSchema: () => (/* binding */ snapRequestSchema),\n/* harmony export */   solidBackgroundSchema: () => (/* binding */ solidBackgroundSchema),\n/* harmony export */   styleConfigSchema: () => (/* binding */ styleConfigSchema),\n/* harmony export */   validateSnapQuery: () => (/* binding */ validateSnapQuery),\n/* harmony export */   validateSnapRequest: () => (/* binding */ validateSnapRequest),\n/* harmony export */   viewportConfigSchema: () => (/* binding */ viewportConfigSchema)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n\nconst urlRegex = /^https?:\\/\\/(?:[-\\w.])+(?:\\:[0-9]+)?(?:\\/(?:[\\w\\/_.])*(?:\\?(?:[\\w&=%.])*)?(?:\\#(?:[\\w.])*)?)?$/;\nconst gradientDirectionSchema = zod__WEBPACK_IMPORTED_MODULE_0__[\"enum\"]([\n    \"to-r\",\n    \"to-l\",\n    \"to-t\",\n    \"to-b\",\n    \"to-br\",\n    \"to-bl\",\n    \"to-tr\",\n    \"to-tl\"\n]);\nconst colorSchemeSchema = zod__WEBPACK_IMPORTED_MODULE_0__[\"enum\"]([\n    \"light\",\n    \"dark\"\n]);\nconst browserMockupSchema = zod__WEBPACK_IMPORTED_MODULE_0__[\"enum\"]([\n    \"safari\",\n    \"chrome\",\n    \"firefox\",\n    \"edge\",\n    \"none\"\n]);\nconst gradientColorSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    color: zod__WEBPACK_IMPORTED_MODULE_0__.string().regex(/^#[0-9A-Fa-f]{6}$|^#[0-9A-Fa-f]{3}$|^rgb\\(|^rgba\\(|^hsl\\(|^hsla\\(/),\n    position: zod__WEBPACK_IMPORTED_MODULE_0__.number().min(0).max(100).optional()\n});\nconst solidBackgroundSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"solid\"),\n    color: zod__WEBPACK_IMPORTED_MODULE_0__.string().regex(/^#[0-9A-Fa-f]{6}$|^#[0-9A-Fa-f]{3}$|^rgb\\(|^rgba\\(|^hsl\\(|^hsla\\(/)\n});\nconst gradientBackgroundSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    type: zod__WEBPACK_IMPORTED_MODULE_0__.literal(\"gradient\"),\n    direction: gradientDirectionSchema,\n    colors: zod__WEBPACK_IMPORTED_MODULE_0__.array(gradientColorSchema).min(2).max(5)\n});\nconst backgroundStyleSchema = zod__WEBPACK_IMPORTED_MODULE_0__.union([\n    solidBackgroundSchema,\n    gradientBackgroundSchema\n]);\nconst viewportConfigSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    width: zod__WEBPACK_IMPORTED_MODULE_0__.number().min(320).max(4096).default(1920),\n    height: zod__WEBPACK_IMPORTED_MODULE_0__.number().min(240).max(4096).default(1080),\n    isMobile: zod__WEBPACK_IMPORTED_MODULE_0__.boolean().default(false),\n    deviceScaleFactor: zod__WEBPACK_IMPORTED_MODULE_0__.number().min(0.5).max(3).default(1)\n});\nconst screenshotConfigSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    url: zod__WEBPACK_IMPORTED_MODULE_0__.string().regex(urlRegex, \"Invalid URL format\"),\n    waitUntil: zod__WEBPACK_IMPORTED_MODULE_0__[\"enum\"]([\n        \"load\",\n        \"domcontentloaded\",\n        \"networkidle0\",\n        \"networkidle2\"\n    ]).default(\"networkidle0\"),\n    delay: zod__WEBPACK_IMPORTED_MODULE_0__.number().min(0).max(10000).default(2000),\n    colorScheme: colorSchemeSchema.default(\"dark\"),\n    viewport: viewportConfigSchema.default({})\n});\nconst shadowConfigSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    enabled: zod__WEBPACK_IMPORTED_MODULE_0__.boolean().default(true),\n    blur: zod__WEBPACK_IMPORTED_MODULE_0__.number().min(0).max(50).default(20),\n    offsetX: zod__WEBPACK_IMPORTED_MODULE_0__.number().min(-50).max(50).default(0),\n    offsetY: zod__WEBPACK_IMPORTED_MODULE_0__.number().min(-50).max(50).default(10),\n    color: zod__WEBPACK_IMPORTED_MODULE_0__.string().regex(/^#[0-9A-Fa-f]{6}$|^#[0-9A-Fa-f]{3}$|^rgb\\(|^rgba\\(|^hsl\\(|^hsla\\(/).default(\"#000000\"),\n    opacity: zod__WEBPACK_IMPORTED_MODULE_0__.number().min(0).max(1).default(0.15)\n});\nconst finalImageSizeSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    width: zod__WEBPACK_IMPORTED_MODULE_0__.number().min(100).max(4096).optional(),\n    height: zod__WEBPACK_IMPORTED_MODULE_0__.number().min(100).max(4096).optional(),\n    aspectRatio: zod__WEBPACK_IMPORTED_MODULE_0__.string().regex(/^\\d+:\\d+$/).optional(),\n    maintainAspectRatio: zod__WEBPACK_IMPORTED_MODULE_0__.boolean().default(true)\n});\nconst styleConfigSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    borderRadius: zod__WEBPACK_IMPORTED_MODULE_0__.number().min(0).max(50).default(8),\n    margin: zod__WEBPACK_IMPORTED_MODULE_0__.number().min(0).max(200).default(32),\n    background: backgroundStyleSchema.default({\n        type: \"gradient\",\n        direction: \"to-br\",\n        colors: [\n            {\n                color: \"#667eea\",\n                position: 0\n            },\n            {\n                color: \"#764ba2\",\n                position: 100\n            }\n        ]\n    }),\n    browserMockup: browserMockupSchema.default(\"none\"),\n    finalSize: finalImageSizeSchema.optional(),\n    shadow: shadowConfigSchema.default({})\n});\nconst snapRequestSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    url: zod__WEBPACK_IMPORTED_MODULE_0__.string().regex(urlRegex, \"Invalid URL format\"),\n    screenshot: screenshotConfigSchema.partial().optional(),\n    style: styleConfigSchema.partial().optional()\n});\n// Custom number coercion that handles empty strings and invalid values\nconst safeNumberCoercion = (min, max)=>zod__WEBPACK_IMPORTED_MODULE_0__.preprocess((val)=>{\n        if (val === \"\" || val === undefined || val === null) return undefined;\n        const num = Number(val);\n        return isNaN(num) ? undefined : num;\n    }, zod__WEBPACK_IMPORTED_MODULE_0__.number().min(min ?? -Infinity).max(max ?? Infinity).optional());\nconst safeBooleanCoercion = ()=>zod__WEBPACK_IMPORTED_MODULE_0__.preprocess((val)=>{\n        if (val === \"\" || val === undefined || val === null) return undefined;\n        return val === \"true\" || val === true;\n    }, zod__WEBPACK_IMPORTED_MODULE_0__.boolean().optional());\nconst snapQuerySchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    url: zod__WEBPACK_IMPORTED_MODULE_0__.string().regex(urlRegex, \"Invalid URL format\"),\n    waitUntil: zod__WEBPACK_IMPORTED_MODULE_0__[\"enum\"]([\n        \"load\",\n        \"domcontentloaded\",\n        \"networkidle0\",\n        \"networkidle2\"\n    ]).optional(),\n    delay: safeNumberCoercion(0, 10000),\n    colorScheme: colorSchemeSchema.optional(),\n    \"viewport.width\": safeNumberCoercion(320, 4096),\n    \"viewport.height\": safeNumberCoercion(240, 4096),\n    \"viewport.isMobile\": safeBooleanCoercion(),\n    \"viewport.deviceScaleFactor\": safeNumberCoercion(0.5, 3),\n    borderRadius: safeNumberCoercion(0, 50),\n    margin: safeNumberCoercion(0, 200),\n    \"background.type\": zod__WEBPACK_IMPORTED_MODULE_0__[\"enum\"]([\n        \"solid\",\n        \"gradient\"\n    ]).optional(),\n    \"background.color\": zod__WEBPACK_IMPORTED_MODULE_0__.string().regex(/^#[0-9A-Fa-f]{6}$|^#[0-9A-Fa-f]{3}$|^rgb\\(|^rgba\\(|^hsl\\(|^hsla\\(/).optional(),\n    \"background.direction\": gradientDirectionSchema.optional(),\n    \"background.colors\": zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n    browserMockup: browserMockupSchema.optional(),\n    // Final image size parameters\n    \"finalSize.width\": safeNumberCoercion(100, 4096),\n    \"finalSize.height\": safeNumberCoercion(100, 4096),\n    \"finalSize.aspectRatio\": zod__WEBPACK_IMPORTED_MODULE_0__.string().regex(/^\\d+:\\d+$/).optional(),\n    \"finalSize.maintainAspectRatio\": safeBooleanCoercion(),\n    \"shadow.enabled\": safeBooleanCoercion(),\n    \"shadow.blur\": safeNumberCoercion(0, 50),\n    \"shadow.offsetX\": safeNumberCoercion(-50, 50),\n    \"shadow.offsetY\": safeNumberCoercion(-50, 50),\n    \"shadow.color\": zod__WEBPACK_IMPORTED_MODULE_0__.string().regex(/^#[0-9A-Fa-f]{6}$|^#[0-9A-Fa-f]{3}$|^rgb\\(|^rgba\\(|^hsl\\(|^hsla\\(/).optional(),\n    \"shadow.opacity\": safeNumberCoercion(0, 1)\n});\nfunction validateSnapRequest(data) {\n    return snapRequestSchema.parse(data);\n}\nfunction validateSnapQuery(data) {\n    return snapQuerySchema.parse(data);\n}\nfunction queryToRequest(query) {\n    const request = {\n        url: query.url,\n        screenshot: {},\n        style: {}\n    };\n    if (query.waitUntil) request.screenshot.waitUntil = query.waitUntil;\n    if (query.delay) request.screenshot.delay = query.delay;\n    if (query.colorScheme) request.screenshot.colorScheme = query.colorScheme;\n    if (query[\"viewport.width\"] || query[\"viewport.height\"] || query[\"viewport.isMobile\"] !== undefined || query[\"viewport.deviceScaleFactor\"]) {\n        request.screenshot.viewport = {};\n        if (query[\"viewport.width\"]) request.screenshot.viewport.width = query[\"viewport.width\"];\n        if (query[\"viewport.height\"]) request.screenshot.viewport.height = query[\"viewport.height\"];\n        if (query[\"viewport.isMobile\"] !== undefined) request.screenshot.viewport.isMobile = query[\"viewport.isMobile\"];\n        if (query[\"viewport.deviceScaleFactor\"]) request.screenshot.viewport.deviceScaleFactor = query[\"viewport.deviceScaleFactor\"];\n    }\n    if (query.borderRadius) request.style.borderRadius = query.borderRadius;\n    if (query.margin) request.style.margin = query.margin;\n    if (query.browserMockup) request.style.browserMockup = query.browserMockup;\n    if (query[\"background.type\"] || query[\"background.color\"] || query[\"background.direction\"] || query[\"background.colors\"]) {\n        if (query[\"background.type\"] === \"solid\" && query[\"background.color\"]) {\n            request.style.background = {\n                type: \"solid\",\n                color: query[\"background.color\"]\n            };\n        } else if (query[\"background.type\"] === \"gradient\" && query[\"background.colors\"]) {\n            try {\n                const colors = JSON.parse(query[\"background.colors\"]);\n                request.style.background = {\n                    type: \"gradient\",\n                    direction: query[\"background.direction\"] || \"to-br\",\n                    colors: Array.isArray(colors) ? colors : []\n                };\n            } catch (e) {\n            // Invalid JSON, ignore\n            }\n        }\n    }\n    // Handle finalSize parameters\n    if (query[\"finalSize.width\"] || query[\"finalSize.height\"] || query[\"finalSize.aspectRatio\"] || query[\"finalSize.maintainAspectRatio\"] !== undefined) {\n        request.style.finalSize = {};\n        if (query[\"finalSize.width\"]) request.style.finalSize.width = query[\"finalSize.width\"];\n        if (query[\"finalSize.height\"]) request.style.finalSize.height = query[\"finalSize.height\"];\n        if (query[\"finalSize.aspectRatio\"]) request.style.finalSize.aspectRatio = query[\"finalSize.aspectRatio\"];\n        if (query[\"finalSize.maintainAspectRatio\"] !== undefined) request.style.finalSize.maintainAspectRatio = query[\"finalSize.maintainAspectRatio\"];\n    }\n    if (query[\"shadow.enabled\"] !== undefined || query[\"shadow.blur\"] || query[\"shadow.offsetX\"] || query[\"shadow.offsetY\"] || query[\"shadow.color\"] || query[\"shadow.opacity\"]) {\n        request.style.shadow = {};\n        if (query[\"shadow.enabled\"] !== undefined) request.style.shadow.enabled = query[\"shadow.enabled\"];\n        if (query[\"shadow.blur\"]) request.style.shadow.blur = query[\"shadow.blur\"];\n        if (query[\"shadow.offsetX\"]) request.style.shadow.offsetX = query[\"shadow.offsetX\"];\n        if (query[\"shadow.offsetY\"]) request.style.shadow.offsetY = query[\"shadow.offsetY\"];\n        if (query[\"shadow.color\"]) request.style.shadow.color = query[\"shadow.color\"];\n        if (query[\"shadow.opacity\"]) request.style.shadow.opacity = query[\"shadow.opacity\"];\n    }\n    return request;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SyxDQUFDLGVBQWUsSUFBSUEsS0FBSyxDQUFDLGlCQUFpQixFQUFFO1FBQzNLQyxRQUFRakIsS0FBSyxDQUFFSixNQUFNLEdBQUcsQ0FBQztRQUN6QixJQUFJb0IsS0FBSyxDQUFDLGlCQUFpQixLQUFLWixXQUFXYSxRQUFRakIsS0FBSyxDQUFFSixNQUFNLENBQUVkLE9BQU8sR0FBR2tDLEtBQUssQ0FBQyxpQkFBaUI7UUFDbkcsSUFBSUEsS0FBSyxDQUFDLGNBQWMsRUFBRUMsUUFBUWpCLEtBQUssQ0FBRUosTUFBTSxDQUFFYixJQUFJLEdBQUdpQyxLQUFLLENBQUMsY0FBYztRQUM1RSxJQUFJQSxLQUFLLENBQUMsaUJBQWlCLEVBQUVDLFFBQVFqQixLQUFLLENBQUVKLE1BQU0sQ0FBRVosT0FBTyxHQUFHZ0MsS0FBSyxDQUFDLGlCQUFpQjtRQUNyRixJQUFJQSxLQUFLLENBQUMsaUJBQWlCLEVBQUVDLFFBQVFqQixLQUFLLENBQUVKLE1BQU0sQ0FBRVgsT0FBTyxHQUFHK0IsS0FBSyxDQUFDLGlCQUFpQjtRQUNyRixJQUFJQSxLQUFLLENBQUMsZUFBZSxFQUFFQyxRQUFRakIsS0FBSyxDQUFFSixNQUFNLENBQUU3QyxLQUFLLEdBQUdpRSxLQUFLLENBQUMsZUFBZTtRQUMvRSxJQUFJQSxLQUFLLENBQUMsaUJBQWlCLEVBQUVDLFFBQVFqQixLQUFLLENBQUVKLE1BQU0sQ0FBRVYsT0FBTyxHQUFHOEIsS0FBSyxDQUFDLGlCQUFpQjtJQUN2RjtJQUVBLE9BQU9DO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbmFwLy4vc3JjL2xpYi92YWxpZGF0aW9uLnRzPzQ2MGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5cbmNvbnN0IHVybFJlZ2V4ID0gL15odHRwcz86XFwvXFwvKD86Wy1cXHcuXSkrKD86XFw6WzAtOV0rKT8oPzpcXC8oPzpbXFx3XFwvXy5dKSooPzpcXD8oPzpbXFx3Jj0lLl0pKik/KD86XFwjKD86W1xcdy5dKSopPyk/JC87XG5cbmV4cG9ydCBjb25zdCBncmFkaWVudERpcmVjdGlvblNjaGVtYSA9IHouZW51bShbXG4gICd0by1yJywgJ3RvLWwnLCAndG8tdCcsICd0by1iJywgJ3RvLWJyJywgJ3RvLWJsJywgJ3RvLXRyJywgJ3RvLXRsJ1xuXSk7XG5cbmV4cG9ydCBjb25zdCBjb2xvclNjaGVtZVNjaGVtYSA9IHouZW51bShbJ2xpZ2h0JywgJ2RhcmsnXSk7XG5cbmV4cG9ydCBjb25zdCBicm93c2VyTW9ja3VwU2NoZW1hID0gei5lbnVtKFsnc2FmYXJpJywgJ2Nocm9tZScsICdmaXJlZm94JywgJ2VkZ2UnLCAnbm9uZSddKTtcblxuZXhwb3J0IGNvbnN0IGdyYWRpZW50Q29sb3JTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGNvbG9yOiB6LnN0cmluZygpLnJlZ2V4KC9eI1swLTlBLUZhLWZdezZ9JHxeI1swLTlBLUZhLWZdezN9JHxecmdiXFwofF5yZ2JhXFwofF5oc2xcXCh8XmhzbGFcXCgvKSxcbiAgcG9zaXRpb246IHoubnVtYmVyKCkubWluKDApLm1heCgxMDApLm9wdGlvbmFsKClcbn0pO1xuXG5leHBvcnQgY29uc3Qgc29saWRCYWNrZ3JvdW5kU2NoZW1hID0gei5vYmplY3Qoe1xuICB0eXBlOiB6LmxpdGVyYWwoJ3NvbGlkJyksXG4gIGNvbG9yOiB6LnN0cmluZygpLnJlZ2V4KC9eI1swLTlBLUZhLWZdezZ9JHxeI1swLTlBLUZhLWZdezN9JHxecmdiXFwofF5yZ2JhXFwofF5oc2xcXCh8XmhzbGFcXCgvKVxufSk7XG5cbmV4cG9ydCBjb25zdCBncmFkaWVudEJhY2tncm91bmRTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHR5cGU6IHoubGl0ZXJhbCgnZ3JhZGllbnQnKSxcbiAgZGlyZWN0aW9uOiBncmFkaWVudERpcmVjdGlvblNjaGVtYSxcbiAgY29sb3JzOiB6LmFycmF5KGdyYWRpZW50Q29sb3JTY2hlbWEpLm1pbigyKS5tYXgoNSlcbn0pO1xuXG5leHBvcnQgY29uc3QgYmFja2dyb3VuZFN0eWxlU2NoZW1hID0gei51bmlvbihbc29saWRCYWNrZ3JvdW5kU2NoZW1hLCBncmFkaWVudEJhY2tncm91bmRTY2hlbWFdKTtcblxuZXhwb3J0IGNvbnN0IHZpZXdwb3J0Q29uZmlnU2NoZW1hID0gei5vYmplY3Qoe1xuICB3aWR0aDogei5udW1iZXIoKS5taW4oMzIwKS5tYXgoNDA5NikuZGVmYXVsdCgxOTIwKSxcbiAgaGVpZ2h0OiB6Lm51bWJlcigpLm1pbigyNDApLm1heCg0MDk2KS5kZWZhdWx0KDEwODApLFxuICBpc01vYmlsZTogei5ib29sZWFuKCkuZGVmYXVsdChmYWxzZSksXG4gIGRldmljZVNjYWxlRmFjdG9yOiB6Lm51bWJlcigpLm1pbigwLjUpLm1heCgzKS5kZWZhdWx0KDEpXG59KTtcblxuZXhwb3J0IGNvbnN0IHNjcmVlbnNob3RDb25maWdTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHVybDogei5zdHJpbmcoKS5yZWdleCh1cmxSZWdleCwgJ0ludmFsaWQgVVJMIGZvcm1hdCcpLFxuICB3YWl0VW50aWw6IHouZW51bShbJ2xvYWQnLCAnZG9tY29udGVudGxvYWRlZCcsICduZXR3b3JraWRsZTAnLCAnbmV0d29ya2lkbGUyJ10pLmRlZmF1bHQoJ25ldHdvcmtpZGxlMCcpLFxuICBkZWxheTogei5udW1iZXIoKS5taW4oMCkubWF4KDEwMDAwKS5kZWZhdWx0KDIwMDApLFxuICBjb2xvclNjaGVtZTogY29sb3JTY2hlbWVTY2hlbWEuZGVmYXVsdCgnZGFyaycpLFxuICB2aWV3cG9ydDogdmlld3BvcnRDb25maWdTY2hlbWEuZGVmYXVsdCh7fSlcbn0pO1xuXG5leHBvcnQgY29uc3Qgc2hhZG93Q29uZmlnU2NoZW1hID0gei5vYmplY3Qoe1xuICBlbmFibGVkOiB6LmJvb2xlYW4oKS5kZWZhdWx0KHRydWUpLFxuICBibHVyOiB6Lm51bWJlcigpLm1pbigwKS5tYXgoNTApLmRlZmF1bHQoMjApLFxuICBvZmZzZXRYOiB6Lm51bWJlcigpLm1pbigtNTApLm1heCg1MCkuZGVmYXVsdCgwKSxcbiAgb2Zmc2V0WTogei5udW1iZXIoKS5taW4oLTUwKS5tYXgoNTApLmRlZmF1bHQoMTApLFxuICBjb2xvcjogei5zdHJpbmcoKS5yZWdleCgvXiNbMC05QS1GYS1mXXs2fSR8XiNbMC05QS1GYS1mXXszfSR8XnJnYlxcKHxecmdiYVxcKHxeaHNsXFwofF5oc2xhXFwoLykuZGVmYXVsdCgnIzAwMDAwMCcpLFxuICBvcGFjaXR5OiB6Lm51bWJlcigpLm1pbigwKS5tYXgoMSkuZGVmYXVsdCgwLjE1KVxufSk7XG5cbmV4cG9ydCBjb25zdCBmaW5hbEltYWdlU2l6ZVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgd2lkdGg6IHoubnVtYmVyKCkubWluKDEwMCkubWF4KDQwOTYpLm9wdGlvbmFsKCksXG4gIGhlaWdodDogei5udW1iZXIoKS5taW4oMTAwKS5tYXgoNDA5Nikub3B0aW9uYWwoKSxcbiAgYXNwZWN0UmF0aW86IHouc3RyaW5nKCkucmVnZXgoL15cXGQrOlxcZCskLykub3B0aW9uYWwoKSwgLy8gZS5nLiwgXCIxNjo5XCIsIFwiNDozXCJcbiAgbWFpbnRhaW5Bc3BlY3RSYXRpbzogei5ib29sZWFuKCkuZGVmYXVsdCh0cnVlKVxufSk7XG5cbmV4cG9ydCBjb25zdCBzdHlsZUNvbmZpZ1NjaGVtYSA9IHoub2JqZWN0KHtcbiAgYm9yZGVyUmFkaXVzOiB6Lm51bWJlcigpLm1pbigwKS5tYXgoNTApLmRlZmF1bHQoOCksXG4gIG1hcmdpbjogei5udW1iZXIoKS5taW4oMCkubWF4KDIwMCkuZGVmYXVsdCgzMiksXG4gIGJhY2tncm91bmQ6IGJhY2tncm91bmRTdHlsZVNjaGVtYS5kZWZhdWx0KHtcbiAgICB0eXBlOiAnZ3JhZGllbnQnLFxuICAgIGRpcmVjdGlvbjogJ3RvLWJyJyxcbiAgICBjb2xvcnM6IFtcbiAgICAgIHsgY29sb3I6ICcjNjY3ZWVhJywgcG9zaXRpb246IDAgfSxcbiAgICAgIHsgY29sb3I6ICcjNzY0YmEyJywgcG9zaXRpb246IDEwMCB9XG4gICAgXVxuICB9KSxcbiAgYnJvd3Nlck1vY2t1cDogYnJvd3Nlck1vY2t1cFNjaGVtYS5kZWZhdWx0KCdub25lJyksXG4gIGZpbmFsU2l6ZTogZmluYWxJbWFnZVNpemVTY2hlbWEub3B0aW9uYWwoKSxcbiAgc2hhZG93OiBzaGFkb3dDb25maWdTY2hlbWEuZGVmYXVsdCh7fSlcbn0pO1xuXG5leHBvcnQgY29uc3Qgc25hcFJlcXVlc3RTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHVybDogei5zdHJpbmcoKS5yZWdleCh1cmxSZWdleCwgJ0ludmFsaWQgVVJMIGZvcm1hdCcpLFxuICBzY3JlZW5zaG90OiBzY3JlZW5zaG90Q29uZmlnU2NoZW1hLnBhcnRpYWwoKS5vcHRpb25hbCgpLFxuICBzdHlsZTogc3R5bGVDb25maWdTY2hlbWEucGFydGlhbCgpLm9wdGlvbmFsKClcbn0pO1xuXG4vLyBDdXN0b20gbnVtYmVyIGNvZXJjaW9uIHRoYXQgaGFuZGxlcyBlbXB0eSBzdHJpbmdzIGFuZCBpbnZhbGlkIHZhbHVlc1xuY29uc3Qgc2FmZU51bWJlckNvZXJjaW9uID0gKG1pbj86IG51bWJlciwgbWF4PzogbnVtYmVyKSA9PiBcbiAgei5wcmVwcm9jZXNzKCh2YWwpID0+IHtcbiAgICBpZiAodmFsID09PSAnJyB8fCB2YWwgPT09IHVuZGVmaW5lZCB8fCB2YWwgPT09IG51bGwpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgY29uc3QgbnVtID0gTnVtYmVyKHZhbCk7XG4gICAgcmV0dXJuIGlzTmFOKG51bSkgPyB1bmRlZmluZWQgOiBudW07XG4gIH0sIHoubnVtYmVyKCkubWluKG1pbiA/PyAtSW5maW5pdHkpLm1heChtYXggPz8gSW5maW5pdHkpLm9wdGlvbmFsKCkpO1xuXG5jb25zdCBzYWZlQm9vbGVhbkNvZXJjaW9uID0gKCkgPT5cbiAgei5wcmVwcm9jZXNzKCh2YWwpID0+IHtcbiAgICBpZiAodmFsID09PSAnJyB8fCB2YWwgPT09IHVuZGVmaW5lZCB8fCB2YWwgPT09IG51bGwpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgcmV0dXJuIHZhbCA9PT0gJ3RydWUnIHx8IHZhbCA9PT0gdHJ1ZTtcbiAgfSwgei5ib29sZWFuKCkub3B0aW9uYWwoKSk7XG5cbmV4cG9ydCBjb25zdCBzbmFwUXVlcnlTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHVybDogei5zdHJpbmcoKS5yZWdleCh1cmxSZWdleCwgJ0ludmFsaWQgVVJMIGZvcm1hdCcpLFxuICBcbiAgd2FpdFVudGlsOiB6LmVudW0oWydsb2FkJywgJ2RvbWNvbnRlbnRsb2FkZWQnLCAnbmV0d29ya2lkbGUwJywgJ25ldHdvcmtpZGxlMiddKS5vcHRpb25hbCgpLFxuICBkZWxheTogc2FmZU51bWJlckNvZXJjaW9uKDAsIDEwMDAwKSxcbiAgY29sb3JTY2hlbWU6IGNvbG9yU2NoZW1lU2NoZW1hLm9wdGlvbmFsKCksXG4gIFxuICAndmlld3BvcnQud2lkdGgnOiBzYWZlTnVtYmVyQ29lcmNpb24oMzIwLCA0MDk2KSxcbiAgJ3ZpZXdwb3J0LmhlaWdodCc6IHNhZmVOdW1iZXJDb2VyY2lvbigyNDAsIDQwOTYpLFxuICAndmlld3BvcnQuaXNNb2JpbGUnOiBzYWZlQm9vbGVhbkNvZXJjaW9uKCksXG4gICd2aWV3cG9ydC5kZXZpY2VTY2FsZUZhY3Rvcic6IHNhZmVOdW1iZXJDb2VyY2lvbigwLjUsIDMpLFxuICBcbiAgYm9yZGVyUmFkaXVzOiBzYWZlTnVtYmVyQ29lcmNpb24oMCwgNTApLFxuICBtYXJnaW46IHNhZmVOdW1iZXJDb2VyY2lvbigwLCAyMDApLFxuICBcbiAgJ2JhY2tncm91bmQudHlwZSc6IHouZW51bShbJ3NvbGlkJywgJ2dyYWRpZW50J10pLm9wdGlvbmFsKCksXG4gICdiYWNrZ3JvdW5kLmNvbG9yJzogei5zdHJpbmcoKS5yZWdleCgvXiNbMC05QS1GYS1mXXs2fSR8XiNbMC05QS1GYS1mXXszfSR8XnJnYlxcKHxecmdiYVxcKHxeaHNsXFwofF5oc2xhXFwoLykub3B0aW9uYWwoKSxcbiAgJ2JhY2tncm91bmQuZGlyZWN0aW9uJzogZ3JhZGllbnREaXJlY3Rpb25TY2hlbWEub3B0aW9uYWwoKSxcbiAgJ2JhY2tncm91bmQuY29sb3JzJzogei5zdHJpbmcoKS5vcHRpb25hbCgpLCAvLyBKU09OIHN0cmluZyBvZiBncmFkaWVudCBjb2xvcnNcbiAgXG4gIGJyb3dzZXJNb2NrdXA6IGJyb3dzZXJNb2NrdXBTY2hlbWEub3B0aW9uYWwoKSxcbiAgXG4gIC8vIEZpbmFsIGltYWdlIHNpemUgcGFyYW1ldGVyc1xuICAnZmluYWxTaXplLndpZHRoJzogc2FmZU51bWJlckNvZXJjaW9uKDEwMCwgNDA5NiksXG4gICdmaW5hbFNpemUuaGVpZ2h0Jzogc2FmZU51bWJlckNvZXJjaW9uKDEwMCwgNDA5NiksXG4gICdmaW5hbFNpemUuYXNwZWN0UmF0aW8nOiB6LnN0cmluZygpLnJlZ2V4KC9eXFxkKzpcXGQrJC8pLm9wdGlvbmFsKCksXG4gICdmaW5hbFNpemUubWFpbnRhaW5Bc3BlY3RSYXRpbyc6IHNhZmVCb29sZWFuQ29lcmNpb24oKSxcbiAgXG4gICdzaGFkb3cuZW5hYmxlZCc6IHNhZmVCb29sZWFuQ29lcmNpb24oKSxcbiAgJ3NoYWRvdy5ibHVyJzogc2FmZU51bWJlckNvZXJjaW9uKDAsIDUwKSxcbiAgJ3NoYWRvdy5vZmZzZXRYJzogc2FmZU51bWJlckNvZXJjaW9uKC01MCwgNTApLFxuICAnc2hhZG93Lm9mZnNldFknOiBzYWZlTnVtYmVyQ29lcmNpb24oLTUwLCA1MCksXG4gICdzaGFkb3cuY29sb3InOiB6LnN0cmluZygpLnJlZ2V4KC9eI1swLTlBLUZhLWZdezZ9JHxeI1swLTlBLUZhLWZdezN9JHxecmdiXFwofF5yZ2JhXFwofF5oc2xcXCh8XmhzbGFcXCgvKS5vcHRpb25hbCgpLFxuICAnc2hhZG93Lm9wYWNpdHknOiBzYWZlTnVtYmVyQ29lcmNpb24oMCwgMSlcbn0pO1xuXG5leHBvcnQgdHlwZSBTbmFwUmVxdWVzdElucHV0ID0gei5pbnB1dDx0eXBlb2Ygc25hcFJlcXVlc3RTY2hlbWE+O1xuZXhwb3J0IHR5cGUgU25hcFF1ZXJ5SW5wdXQgPSB6LmlucHV0PHR5cGVvZiBzbmFwUXVlcnlTY2hlbWE+O1xuZXhwb3J0IHR5cGUgVmFsaWRhdGVkU25hcFJlcXVlc3QgPSB6Lm91dHB1dDx0eXBlb2Ygc25hcFJlcXVlc3RTY2hlbWE+O1xuZXhwb3J0IHR5cGUgVmFsaWRhdGVkU25hcFF1ZXJ5ID0gei5vdXRwdXQ8dHlwZW9mIHNuYXBRdWVyeVNjaGVtYT47XG5cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVNuYXBSZXF1ZXN0KGRhdGE6IHVua25vd24pOiBWYWxpZGF0ZWRTbmFwUmVxdWVzdCB7XG4gIHJldHVybiBzbmFwUmVxdWVzdFNjaGVtYS5wYXJzZShkYXRhKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlU25hcFF1ZXJ5KGRhdGE6IHVua25vd24pOiBWYWxpZGF0ZWRTbmFwUXVlcnkge1xuICByZXR1cm4gc25hcFF1ZXJ5U2NoZW1hLnBhcnNlKGRhdGEpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcXVlcnlUb1JlcXVlc3QocXVlcnk6IFZhbGlkYXRlZFNuYXBRdWVyeSk6IFZhbGlkYXRlZFNuYXBSZXF1ZXN0IHtcbiAgY29uc3QgcmVxdWVzdDogVmFsaWRhdGVkU25hcFJlcXVlc3QgPSB7XG4gICAgdXJsOiBxdWVyeS51cmwsXG4gICAgc2NyZWVuc2hvdDoge30sXG4gICAgc3R5bGU6IHt9XG4gIH07XG5cbiAgaWYgKHF1ZXJ5LndhaXRVbnRpbCkgcmVxdWVzdC5zY3JlZW5zaG90IS53YWl0VW50aWwgPSBxdWVyeS53YWl0VW50aWw7XG4gIGlmIChxdWVyeS5kZWxheSkgcmVxdWVzdC5zY3JlZW5zaG90IS5kZWxheSA9IHF1ZXJ5LmRlbGF5O1xuICBpZiAocXVlcnkuY29sb3JTY2hlbWUpIHJlcXVlc3Quc2NyZWVuc2hvdCEuY29sb3JTY2hlbWUgPSBxdWVyeS5jb2xvclNjaGVtZTtcblxuICBpZiAocXVlcnlbJ3ZpZXdwb3J0LndpZHRoJ10gfHwgcXVlcnlbJ3ZpZXdwb3J0LmhlaWdodCddIHx8IHF1ZXJ5Wyd2aWV3cG9ydC5pc01vYmlsZSddICE9PSB1bmRlZmluZWQgfHwgcXVlcnlbJ3ZpZXdwb3J0LmRldmljZVNjYWxlRmFjdG9yJ10pIHtcbiAgICByZXF1ZXN0LnNjcmVlbnNob3QhLnZpZXdwb3J0ID0ge30gYXMgYW55O1xuICAgIGlmIChxdWVyeVsndmlld3BvcnQud2lkdGgnXSkgcmVxdWVzdC5zY3JlZW5zaG90IS52aWV3cG9ydCEud2lkdGggPSBxdWVyeVsndmlld3BvcnQud2lkdGgnXTtcbiAgICBpZiAocXVlcnlbJ3ZpZXdwb3J0LmhlaWdodCddKSByZXF1ZXN0LnNjcmVlbnNob3QhLnZpZXdwb3J0IS5oZWlnaHQgPSBxdWVyeVsndmlld3BvcnQuaGVpZ2h0J107XG4gICAgaWYgKHF1ZXJ5Wyd2aWV3cG9ydC5pc01vYmlsZSddICE9PSB1bmRlZmluZWQpIHJlcXVlc3Quc2NyZWVuc2hvdCEudmlld3BvcnQhLmlzTW9iaWxlID0gcXVlcnlbJ3ZpZXdwb3J0LmlzTW9iaWxlJ107XG4gICAgaWYgKHF1ZXJ5Wyd2aWV3cG9ydC5kZXZpY2VTY2FsZUZhY3RvciddKSByZXF1ZXN0LnNjcmVlbnNob3QhLnZpZXdwb3J0IS5kZXZpY2VTY2FsZUZhY3RvciA9IHF1ZXJ5Wyd2aWV3cG9ydC5kZXZpY2VTY2FsZUZhY3RvciddO1xuICB9XG5cbiAgaWYgKHF1ZXJ5LmJvcmRlclJhZGl1cykgcmVxdWVzdC5zdHlsZSEuYm9yZGVyUmFkaXVzID0gcXVlcnkuYm9yZGVyUmFkaXVzO1xuICBpZiAocXVlcnkubWFyZ2luKSByZXF1ZXN0LnN0eWxlIS5tYXJnaW4gPSBxdWVyeS5tYXJnaW47XG4gIGlmIChxdWVyeS5icm93c2VyTW9ja3VwKSByZXF1ZXN0LnN0eWxlIS5icm93c2VyTW9ja3VwID0gcXVlcnkuYnJvd3Nlck1vY2t1cDtcblxuICBpZiAocXVlcnlbJ2JhY2tncm91bmQudHlwZSddIHx8IHF1ZXJ5WydiYWNrZ3JvdW5kLmNvbG9yJ10gfHwgcXVlcnlbJ2JhY2tncm91bmQuZGlyZWN0aW9uJ10gfHwgcXVlcnlbJ2JhY2tncm91bmQuY29sb3JzJ10pIHtcbiAgICBpZiAocXVlcnlbJ2JhY2tncm91bmQudHlwZSddID09PSAnc29saWQnICYmIHF1ZXJ5WydiYWNrZ3JvdW5kLmNvbG9yJ10pIHtcbiAgICAgIHJlcXVlc3Quc3R5bGUhLmJhY2tncm91bmQgPSB7XG4gICAgICAgIHR5cGU6ICdzb2xpZCcsXG4gICAgICAgIGNvbG9yOiBxdWVyeVsnYmFja2dyb3VuZC5jb2xvciddXG4gICAgICB9O1xuICAgIH0gZWxzZSBpZiAocXVlcnlbJ2JhY2tncm91bmQudHlwZSddID09PSAnZ3JhZGllbnQnICYmIHF1ZXJ5WydiYWNrZ3JvdW5kLmNvbG9ycyddKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBjb2xvcnMgPSBKU09OLnBhcnNlKHF1ZXJ5WydiYWNrZ3JvdW5kLmNvbG9ycyddKTtcbiAgICAgICAgcmVxdWVzdC5zdHlsZSEuYmFja2dyb3VuZCA9IHtcbiAgICAgICAgICB0eXBlOiAnZ3JhZGllbnQnLFxuICAgICAgICAgIGRpcmVjdGlvbjogcXVlcnlbJ2JhY2tncm91bmQuZGlyZWN0aW9uJ10gfHwgJ3RvLWJyJyxcbiAgICAgICAgICBjb2xvcnM6IEFycmF5LmlzQXJyYXkoY29sb3JzKSA/IGNvbG9ycyA6IFtdXG4gICAgICAgIH07XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIC8vIEludmFsaWQgSlNPTiwgaWdub3JlXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gSGFuZGxlIGZpbmFsU2l6ZSBwYXJhbWV0ZXJzXG4gIGlmIChxdWVyeVsnZmluYWxTaXplLndpZHRoJ10gfHwgcXVlcnlbJ2ZpbmFsU2l6ZS5oZWlnaHQnXSB8fCBxdWVyeVsnZmluYWxTaXplLmFzcGVjdFJhdGlvJ10gfHwgcXVlcnlbJ2ZpbmFsU2l6ZS5tYWludGFpbkFzcGVjdFJhdGlvJ10gIT09IHVuZGVmaW5lZCkge1xuICAgIHJlcXVlc3Quc3R5bGUhLmZpbmFsU2l6ZSA9IHt9O1xuICAgIGlmIChxdWVyeVsnZmluYWxTaXplLndpZHRoJ10pIHJlcXVlc3Quc3R5bGUhLmZpbmFsU2l6ZS53aWR0aCA9IHF1ZXJ5WydmaW5hbFNpemUud2lkdGgnXTtcbiAgICBpZiAocXVlcnlbJ2ZpbmFsU2l6ZS5oZWlnaHQnXSkgcmVxdWVzdC5zdHlsZSEuZmluYWxTaXplLmhlaWdodCA9IHF1ZXJ5WydmaW5hbFNpemUuaGVpZ2h0J107XG4gICAgaWYgKHF1ZXJ5WydmaW5hbFNpemUuYXNwZWN0UmF0aW8nXSkgcmVxdWVzdC5zdHlsZSEuZmluYWxTaXplLmFzcGVjdFJhdGlvID0gcXVlcnlbJ2ZpbmFsU2l6ZS5hc3BlY3RSYXRpbyddO1xuICAgIGlmIChxdWVyeVsnZmluYWxTaXplLm1haW50YWluQXNwZWN0UmF0aW8nXSAhPT0gdW5kZWZpbmVkKSByZXF1ZXN0LnN0eWxlIS5maW5hbFNpemUubWFpbnRhaW5Bc3BlY3RSYXRpbyA9IHF1ZXJ5WydmaW5hbFNpemUubWFpbnRhaW5Bc3BlY3RSYXRpbyddO1xuICB9XG5cbiAgaWYgKHF1ZXJ5WydzaGFkb3cuZW5hYmxlZCddICE9PSB1bmRlZmluZWQgfHwgcXVlcnlbJ3NoYWRvdy5ibHVyJ10gfHwgcXVlcnlbJ3NoYWRvdy5vZmZzZXRYJ10gfHwgcXVlcnlbJ3NoYWRvdy5vZmZzZXRZJ10gfHwgcXVlcnlbJ3NoYWRvdy5jb2xvciddIHx8IHF1ZXJ5WydzaGFkb3cub3BhY2l0eSddKSB7XG4gICAgcmVxdWVzdC5zdHlsZSEuc2hhZG93ID0ge30gYXMgYW55O1xuICAgIGlmIChxdWVyeVsnc2hhZG93LmVuYWJsZWQnXSAhPT0gdW5kZWZpbmVkKSByZXF1ZXN0LnN0eWxlIS5zaGFkb3chLmVuYWJsZWQgPSBxdWVyeVsnc2hhZG93LmVuYWJsZWQnXTtcbiAgICBpZiAocXVlcnlbJ3NoYWRvdy5ibHVyJ10pIHJlcXVlc3Quc3R5bGUhLnNoYWRvdyEuYmx1ciA9IHF1ZXJ5WydzaGFkb3cuYmx1ciddO1xuICAgIGlmIChxdWVyeVsnc2hhZG93Lm9mZnNldFgnXSkgcmVxdWVzdC5zdHlsZSEuc2hhZG93IS5vZmZzZXRYID0gcXVlcnlbJ3NoYWRvdy5vZmZzZXRYJ107XG4gICAgaWYgKHF1ZXJ5WydzaGFkb3cub2Zmc2V0WSddKSByZXF1ZXN0LnN0eWxlIS5zaGFkb3chLm9mZnNldFkgPSBxdWVyeVsnc2hhZG93Lm9mZnNldFknXTtcbiAgICBpZiAocXVlcnlbJ3NoYWRvdy5jb2xvciddKSByZXF1ZXN0LnN0eWxlIS5zaGFkb3chLmNvbG9yID0gcXVlcnlbJ3NoYWRvdy5jb2xvciddO1xuICAgIGlmIChxdWVyeVsnc2hhZG93Lm9wYWNpdHknXSkgcmVxdWVzdC5zdHlsZSEuc2hhZG93IS5vcGFjaXR5ID0gcXVlcnlbJ3NoYWRvdy5vcGFjaXR5J107XG4gIH1cblxuICByZXR1cm4gcmVxdWVzdDtcbn0iXSwibmFtZXMiOlsieiIsInVybFJlZ2V4IiwiZ3JhZGllbnREaXJlY3Rpb25TY2hlbWEiLCJlbnVtIiwiY29sb3JTY2hlbWVTY2hlbWEiLCJicm93c2VyTW9ja3VwU2NoZW1hIiwiZ3JhZGllbnRDb2xvclNjaGVtYSIsIm9iamVjdCIsImNvbG9yIiwic3RyaW5nIiwicmVnZXgiLCJwb3NpdGlvbiIsIm51bWJlciIsIm1pbiIsIm1heCIsIm9wdGlvbmFsIiwic29saWRCYWNrZ3JvdW5kU2NoZW1hIiwidHlwZSIsImxpdGVyYWwiLCJncmFkaWVudEJhY2tncm91bmRTY2hlbWEiLCJkaXJlY3Rpb24iLCJjb2xvcnMiLCJhcnJheSIsImJhY2tncm91bmRTdHlsZVNjaGVtYSIsInVuaW9uIiwidmlld3BvcnRDb25maWdTY2hlbWEiLCJ3aWR0aCIsImRlZmF1bHQiLCJoZWlnaHQiLCJpc01vYmlsZSIsImJvb2xlYW4iLCJkZXZpY2VTY2FsZUZhY3RvciIsInNjcmVlbnNob3RDb25maWdTY2hlbWEiLCJ1cmwiLCJ3YWl0VW50aWwiLCJkZWxheSIsImNvbG9yU2NoZW1lIiwidmlld3BvcnQiLCJzaGFkb3dDb25maWdTY2hlbWEiLCJlbmFibGVkIiwiYmx1ciIsIm9mZnNldFgiLCJvZmZzZXRZIiwib3BhY2l0eSIsImZpbmFsSW1hZ2VTaXplU2NoZW1hIiwiYXNwZWN0UmF0aW8iLCJtYWludGFpbkFzcGVjdFJhdGlvIiwic3R5bGVDb25maWdTY2hlbWEiLCJib3JkZXJSYWRpdXMiLCJtYXJnaW4iLCJiYWNrZ3JvdW5kIiwiYnJvd3Nlck1vY2t1cCIsImZpbmFsU2l6ZSIsInNoYWRvdyIsInNuYXBSZXF1ZXN0U2NoZW1hIiwic2NyZWVuc2hvdCIsInBhcnRpYWwiLCJzdHlsZSIsInNhZmVOdW1iZXJDb2VyY2lvbiIsInByZXByb2Nlc3MiLCJ2YWwiLCJ1bmRlZmluZWQiLCJudW0iLCJOdW1iZXIiLCJpc05hTiIsIkluZmluaXR5Iiwic2FmZUJvb2xlYW5Db2VyY2lvbiIsInNuYXBRdWVyeVNjaGVtYSIsInZhbGlkYXRlU25hcFJlcXVlc3QiLCJkYXRhIiwicGFyc2UiLCJ2YWxpZGF0ZVNuYXBRdWVyeSIsInF1ZXJ5VG9SZXF1ZXN0IiwicXVlcnkiLCJyZXF1ZXN0IiwiSlNPTiIsIkFycmF5IiwiaXNBcnJheSIsImUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/validation.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/zod"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsnap%2Froute&page=%2Fapi%2Fsnap%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsnap%2Froute.ts&appDir=%2FUsers%2Fmxrqz%2Fprojects%2Fmomentum%2Fsnap%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmxrqz%2Fprojects%2Fmomentum%2Fsnap&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();